(this["webpackJsonpvite-quota-bank"]=this["webpackJsonpvite-quota-bank"]||[]).push([[0],{106:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),a=n.n(r),i=n(8),c=n(10),o=n(13),s=function(){function e(t,n){return Object(c.a)(this,e),this._taskTimer=void 0,this._taskInterval=void 0,this._task=void 0,this._callback=void 0,this._task=t,this._taskInterval=n,this}return Object(o.a)(e,[{key:"_run",value:function(){var e=this;this._taskTimer=setTimeout(Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._task){t.next=3;break}return e._onStop(),t.abrupt("return");case 3:return t.next=5,e._task();case 5:if(t.sent){t.next=8;break}return e._onStop(),t.abrupt("return");case 8:e._run();case 9:case"end":return t.stop()}}),t)}))),this._taskInterval)}},{key:"_onStop",value:function(){this._callback&&this._callback()}},{key:"start",value:function(e){this._callback=e,this._taskTimer||this._run()}},{key:"stop",value:function(){this._onStop(),this._taskTimer&&(window.clearTimeout(this._taskTimer),this._taskTimer=void 0)}}]),e}()},131:function(e,t,n){},14:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={QuotaPerUT:21e3,DefaultDecimals:18,DefaultZeroString:"0",InitialNetworkBlockHeight:"0",ViteTokenId:"tti_5649544520544f4b454e6e40",QuotaContractAddress:"vite_0000000000000000000000000000000000000003f6af7459b9",BankContractAddress:"vite_091e12441cc09f51bb84b7950c7a4a3c44b77442eccb789f7a",NetworkStorageSpace:"VQB_NETWORK",WebWalletStorageSpace:"VQB_WEB_WALLET"}},146:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),c=n(18),o=n.n(c),s=(n(131),n(33)),u=n(5),l=n.n(u),d=n(8),h=n(199),f=n(180),v=n(88),b=n(181),j=n(182),p=n(183),m=n(184),x=n(185),O=n(186),g=n(60),k=n(213),w=n(214),y=n(29),_=n(16),S=n(1),A=n(10),q=n(13),R=n(64),C=n(56),N=n(55),F=function(e){Object(C.a)(n,e);var t=Object(N.a)(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return n}(R.a),B=n(107),E=n.n(B);!function(e){e.NetworkBlockHeight="NetworkBlockHeight",e.QuotaRequestUpdated="QuotaRequestUpdated",e.QuotaRequestDeleted="QuotaRequestDeleted"}(r||(r={}));var D=function(e){Object(C.a)(n,e);var t=Object(N.a)(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return Object(q.a)(n,[{key:"emitNetworkBlockHeight",value:function(e){this.emit(r.NetworkBlockHeight,e)}},{key:"emitQuotaRequestUpdated",value:function(e){this.emit(r.QuotaRequestUpdated,e)}},{key:"emitQuotaRequestDeleted",value:function(e){this.emit(r.QuotaRequestDeleted,e)}}]),n}(E.a),I=n(14),Q=n(15),H=n(23),T=function(){function e(){Object(A.a)(this,e)}return Object(q.a)(e,null,[{key:"notNull",value:function(e,t){if(null===e||void 0===e)throw new Error("Unexpected null exception. "+t)}},{key:"notNullOrWhiteSpace",value:function(e,t){if(null===e||void 0===e||""===(null===e||void 0===e?void 0:e.trim()))throw new Error("Unexpected null exception. "+t)}}]),e}(),M=function(){function e(){Object(A.a)(this,e),this._fileUtil=void 0,this._fileUtil=new L}return Object(q.a)(e,[{key:"readFileAsync",value:function(e){return this._fileUtil.readFileAsync(e)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();M.instance=void 0;var W,L=function(){function e(){Object(A.a)(this,e)}return Object(q.a)(e,[{key:"readFileAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.abrupt("return",n.text());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),P=function(){function e(t,n,r,a){var i=this;Object(A.a)(this,e),this._vite=void 0,this._emitter=void 0,this._networkStore=void 0,this._walletManager=void 0,this._contract=void 0,this._offchainMethods=new Map,this._listener=void 0,this.handleResponseAsync=function(){var e=Object(d.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){i._vite.waitForAccountBlockAsync(t,n).then((function(t){var n;0===(null===t||void 0===t?void 0:t.status)?e():r(null!==(n=null===t||void 0===t?void 0:t.statusTxt)&&void 0!==n?n:"Something went wrong.")}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.objectFromEntries=function(e){return Object.fromEntries(e.map((function(e){return[e.name,e.value]})))},this._vite=t,this._emitter=n,this._networkStore=r,this._walletManager=a}return Object(q.a)(e,[{key:"listener",get:function(){if(!this._listener)throw new Error("Listener is not defined.");return this._listener}},{key:"ensureContractExists",value:function(){var e;if(void 0===(null===(e=this._contract)||void 0===e?void 0:e.address))throw new Error("Bank contract is not defined.");return this._contract}},{key:"ensureAccountExists",value:function(){var e=this._walletManager.getActiveAccount();if(void 0===(null===e||void 0===e?void 0:e.address))throw new Error("Login and try again.");return e}},{key:"removeAddressListener",value:function(){this._listener&&this._vite.removeListener(this._listener)}},{key:"initAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,r=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.removeAddressListener(),e.next=3,M.getInstance().readFileAsync("./assets/contracts/QuotaBank.json");case 3:return n=e.sent,this._contract=new Q.b(JSON.parse(n)),this._contract.address=I.a.BankContractAddress,console.log("Contract name:",null===(t=this._contract)||void 0===t?void 0:t.contractName),e.next=9,this._vite.createAddressListenerAsync(this._contract.address);case 9:this._listener=e.sent,this._listener.on((function(e){var t;if(null===(t=r._contract)||void 0===t?void 0:t.abi)for(var n=0;n<e.length;n++){var a=e[n],i=r._vite.decodeVmLog(a.vmlog,r._contract.abi);console.log(null!==i&&void 0!==i?i:a),i&&r.handleVmLogAsync(i)}else console.log("Could not decode vmlog because contract abi is not defined.")}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){console.log("Disposing BankService"),this.removeAddressListener()}},{key:"getOwnerAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ensureContractExists(),e.next=3,this._vite.callOffChainMethodAsync(t.address,this.getOffchainMethodAbi("getOwner"),t.offChain,[]);case 3:return n=e.sent,e.abrupt("return",n[0].value);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRequests",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ensureContractExists(),e.next=3,this._vite.callOffChainMethodAsync(t.address,this.getOffchainMethodAbi("getRequestors"),t.offChain,[]);case 3:return n=e.sent,e.abrupt("return",n[0].value);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRequestByAddress",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureContractExists(),e.next=3,this._vite.callOffChainMethodAsync(n.address,this.getOffchainMethodAbi("getRequest"),n.offChain,[t]);case 3:if(r=e.sent,a=new Q.e(this.objectFromEntries(r)),!this.isEmptyRequest(a)){e.next=7;break}throw new Error("No request found for '".concat(t,"'."));case 7:return a.address=t,a.update(this._networkStore.blockHeight),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureContractExists(),r=this.ensureAccountExists(),e.next=4,this._vite.callContractAsync(r,"CreateRequest",n.abi,[t],I.a.DefaultZeroString,n.address);case 4:return a=e.sent,e.next=7,this.handleResponseAsync(r.address,a.height);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stakeRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"withdrawRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureContractExists(),r=this.ensureAccountExists(),e.next=4,this._vite.callContractAsync(r,"DeleteRequest",n.abi,[t],I.a.DefaultZeroString,n.address);case 4:return a=e.sent,e.next=7,this.handleResponseAsync(r.address,a.height);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOffchainMethodAbi",value:function(e){var t,n=this.ensureContractExists();if(this._offchainMethods.has(e)?t=this._offchainMethods.get(e):(t=n.abi.find((function(t){return"offchain"===t.type&&t.name===e})))&&this._offchainMethods.set(e,t),t)return t;throw new Error("The offchain method '".concat(e,"' does not exist.'"))}},{key:"isEmptyRequest",value:function(e){return H.a.isNullOrDefault(e.expirationHeight,I.a.DefaultZeroString)}},{key:"handleVmLogAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.event!==Q.f.RequestCreated){e.next=9;break}return T.notNullOrWhiteSpace(null===(n=t.args)||void 0===n?void 0:n.addr,"vmlog.args.addr"),e.next=5,this.getRequestByAddress(null===(r=t.args)||void 0===r?void 0:r.addr);case 5:a=e.sent,this._emitter.emitQuotaRequestUpdated(a),e.next=10;break;case 9:t.event===Q.f.RequestDeleted?(T.notNullOrWhiteSpace(null===(i=t.args)||void 0===i?void 0:i.addr,"vmlog.args.addr"),this._emitter.emitQuotaRequestDeleted(null===(c=t.args)||void 0===c?void 0:c.addr)):console.log("Unknown vmlog event.");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),U=n(39),z=[new Q.e({address:"vite_48e7436290e300268ed360a28704d9df9dbcbe485f7ed24cf1",expirationHeight:"1487686"}),new Q.e({address:"vite_7fb28c2b8c3ee3fd5d271f632b16ef81f1f98d136445a1c1cb",expirationHeight:"1987866",note:"Twitter: 0xRomanNiklaus"}),new Q.e({address:"vite_ce9499905e2dacab4972574cc4319f9b9d44020af89a239463",expirationHeight:"1587687",note:"GitHub: niklr",amount:"1500000000000000000000"}),new Q.e({address:"vite_df81e81a5e552f54fccdad71aa0b951ebec6e456f9d0c69ee4",expirationHeight:"1350998",amount:"1500000000000000000000"}),new Q.e({note:"Test 1324"})],V=function(e){Object(C.a)(n,e);var t=Object(N.a)(n);function n(){var e;Object(A.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).getRequests=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){setTimeout((function(){e(z.flatMap((function(e){return e.address?e.address:[]})))}),1e3)})));case 1:case"end":return e.stop()}}),e)}))),e.getRequestByAddress=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var a=z.find((function(e){return e.address===n}));null===a||void 0===a||a.update(e._networkStore.blockHeight),a?setTimeout((function(){t(a)}),100):r("Quota request for '".concat(n,"' not found."))})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.createRequest=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var a=e.ensureAccountExists();if(n)if(a.address&&z.find((function(e){return e.address===a.address})))r("Request already exists.");else{var i=new Q.e({address:a.address,note:n,expirationHeight:e._networkStore.blockHeight+10});i.update(e._networkStore.blockHeight),z.push(i),t(),setTimeout((function(){e._emitter.emitQuotaRequestUpdated(i)}),500)}else setTimeout((function(){r("Request failed. Please try again later.")}),2e3)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.stakeRequest=function(){var t=Object(d.a)(l.a.mark((function t(n,r,a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){if(e.ensureAccountExists(),!r||r<=0)i("Please provide a valid amount.");else if(!a||a<=0)i("Please provide a valid duration.");else{var c=z.find((function(e){return e.address===n}));if(c){c.amount=U.a.toMin(r,I.a.DefaultDecimals),c.expirationHeight=e._networkStore.blockHeight+a;var o=new Q.e(c);o.update(e._networkStore.blockHeight),t(),setTimeout((function(){e._emitter.emitQuotaRequestUpdated(o)}),500)}else i("Request does not exist.")}})));case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.withdrawRequest=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.ensureAccountExists();var a=z.find((function(e){return e.address===n}));if(a){a.amount=void 0;var i=new Q.e(a);i.update(e._networkStore.blockHeight),t(),setTimeout((function(){e._emitter.emitQuotaRequestUpdated(i)}),500)}else r("Request does not exist.")})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.deleteRequest=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.ensureAccountExists();var a=z.find((function(e){return e.address===n}));if(a){var i=z.indexOf(a);i>-1&&z.splice(i,1),setTimeout((function(){t(),e._emitter.emitQuotaRequestDeleted(n)}),500)}else r("Request does not exist.")})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return n}(P),Z=function(){function e(t){Object(A.a)(this,e),this._key=I.a.NetworkStorageSpace,this._emitter=void 0,this._blockHeight=void 0,this._network=void 0,this._defaultNetwork=void 0,this._networks=[new Q.c({id:2,networkId:2,name:"TESTNET",url:"wss://buidl.vite.net/gvite/ws"}),new Q.c({id:3,networkId:2,name:"TESTNET+MOCK",url:"wss://buidl.vite.net/gvite/ws",mock:!0}),new Q.c({id:4,networkId:5,name:"DEBUG",url:"ws://localhost:23457"})],this._emitter=t,this._blockHeight=I.a.InitialNetworkBlockHeight,this._defaultNetwork=this._networks[1]}return Object(q.a)(e,[{key:"blockHeight",get:function(){return this._blockHeight},set:function(e){var t;this._blockHeight=e,null===(t=this._emitter)||void 0===t||t.emitNetworkBlockHeight(e)}},{key:"network",get:function(){if(this._network)return this._network;var e;try{e=localStorage.getItem(this._key)}catch(r){console.error(r)}if(!e)return this.defaultNetwork;try{var t,n=new Q.c(JSON.parse(e));return this._network=this._networks.find((function(e){return e.id===n.id})),null!==(t=this._network)&&void 0!==t?t:this.defaultNetwork}catch(r){return console.log(r),this.defaultNetwork}},set:function(e){e?(this._network=e,localStorage.setItem(this._key,JSON.stringify(e))):(this._network=void 0,localStorage.removeItem(this._key))}},{key:"defaultNetwork",get:function(){return this._defaultNetwork}},{key:"networks",get:function(){var e;return null!==(e=this._networks)&&void 0!==e?e:[]}},{key:"getById",value:function(e){return this._networks.find((function(t){return t.id===e}))}},{key:"clear",value:function(){this._network=void 0,localStorage.removeItem(this._key)}}]),e}(),G=function(){function e(t){var n;Object(A.a)(this,e),this.emitter=void 0,this.networkStore=void 0,this.vite=void 0,this.bank=void 0,this.emitter=new D,this.networkStore=new Z(this.emitter),(null===(n=this.networkStore.network)||void 0===n?void 0:n.mock)?(this.vite=new F,this.bank=new V(this.vite,this.emitter,this.networkStore,t)):(this.vite=new R.a,this.bank=new P(this.vite,this.emitter,this.networkStore,t))}return Object(q.a)(e,[{key:"dispose",value:function(){console.log("Disposing ServiceProvider"),this.vite.dispose(),this.bank.dispose()}}]),e}(),K=i.a.createContext(void 0),J=function(){var e=i.a.useContext(K);if(!e)throw new Error("Component rendered outside the provider tree");return e},Y=function(e){var t=Object(a.useState)(null),n=Object(_.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)(!1),o=Object(_.a)(c,2),s=o[0],u=o[1],h=ve(),f=h.wallet,v=h.walletManager,b=Object(a.useMemo)((function(){return new G(v)}),[v]);if(Object(a.useEffect)((function(){var e,t;if(!b.networkStore.network)throw new Error("Network is not defined");var n={account:null===f||void 0===f||null===(e=f.active)||void 0===e?void 0:e.address,provider:b};return console.log("ConnectedWeb3.account",null===f||void 0===f||null===(t=f.active)||void 0===t?void 0:t.address),function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("initAsync"),null===(t=n.provider.networkStore.network)||void 0===t?void 0:t.url){e.next=5;break}throw new Error("Network is not defined");case 5:return e.next=7,n.provider.vite.initAsync(n.provider.networkStore.network.url);case 7:return e.next=9,n.provider.bank.initAsync();case 9:i(n),u(!0);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){b.dispose()}}),[f,v,b]),!r)return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(nt,{children:[Object(S.jsx)(Ke,{}),Object(S.jsx)(et,{children:Object(S.jsx)(g.a,{children:"Loading..."})}),Object(S.jsx)(we,{})]})});var j=Object(y.a)({},r);return Object(S.jsx)(S.Fragment,{children:s?Object(S.jsx)(K.Provider,{value:j,children:e.children}):Object(S.jsx)(S.Fragment,{})})},X=function(e,t){var n=Object(a.useState)(new Q.d),r=Object(_.a)(n,2),i=r[0],c=r[1],o=function(){var n=Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!t){n.next=6;break}return n.next=4,e.provider.vite.getQuotaByAccount(t);case 4:r=n.sent,c(r);case 6:n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),c(new Q.d);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){o()}),[e]),{quota:i,fetchQuota:o,setQuota:c}},$=n(210),ee=n(31),te=function(){function e(){Object(A.a)(this,e),this._key=I.a.WebWalletStorageSpace}return Object(q.a)(e,[{key:"clear",value:function(){localStorage.removeItem(this._key)}},{key:"getItem",value:function(){var e;try{e=localStorage.getItem(this._key)}catch(t){return void console.error(t)}if(e)try{return new ae(JSON.parse(e))}catch(t){return void console.log(t)}}},{key:"setItem",value:function(e){var t="string"===typeof e?e:JSON.stringify(e);try{localStorage.setItem(this._key,t)}catch(n){console.error(n)}}}]),e}(),ne=function(){function e(){Object(A.a)(this,e),this._store=void 0,this._wallet=void 0,this._mnemonicDeriveIndex=0,this._store=new te,this.initWallet()}return Object(q.a)(e,[{key:"initWallet",value:function(){var e=this._store.getItem();e&&(this._wallet=e,this._mnemonicDeriveIndex=e.accounts.length)}},{key:"getWallet",value:function(){return this._wallet}},{key:"createWallet",value:function(e){if(this.removeWallet(),this.validateMnemonic(e)){var t=this.createAccount(e,0);this._wallet=new ae({active:t,mnemonic:e,accounts:[t]}),this._store.setItem(this._wallet)}return this._wallet}},{key:"removeWallet",value:function(){this._wallet=void 0,this._mnemonicDeriveIndex=0,this._store.clear()}},{key:"getAccountByAddress",value:function(e){var t,n;return null===(t=this._wallet)||void 0===t||null===(n=t.accounts)||void 0===n?void 0:n.find((function(t){return t.address===e}))}},{key:"addAccount",value:function(){var e;if(null===(e=this._wallet)||void 0===e?void 0:e.mnemonic){var t=this.createAccount(this._wallet.mnemonic);return this._wallet.accounts.push(t),this.setActiveAccount(t),t}}},{key:"getActiveAccount",value:function(){var e;return null===(e=this._wallet)||void 0===e?void 0:e.active}},{key:"setActiveAccount",value:function(e){return!!this._wallet&&(this._wallet.active=e,this._store.setItem(this._wallet),!0)}},{key:"getAccounts",value:function(){return this._wallet?this._wallet.accounts:[]}},{key:"createAccount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._mnemonicDeriveIndex,n=ee.wallet.deriveAddress({mnemonics:e,index:t}),r=n.privateKey,a=new re({id:t.toString(),privateKey:r,address:ee.wallet.createAddressByPrivateKey(r).address});return this._mnemonicDeriveIndex=t+1,a}},{key:"validateMnemonic",value:function(e){return!!e&&ee.wallet.validateMnemonics(e)}}]),e}(),re=function(){function e(t){Object(A.a)(this,e),this.id=void 0,this.privateKey=void 0,this.address=void 0,this.init(t)}return Object(q.a)(e,[{key:"init",value:function(e){e&&(this.id=e.id,this.privateKey=e.privateKey,this.address=e.address)}}]),e}(),ae=function(){function e(t){Object(A.a)(this,e),this.active=void 0,this.mnemonic=void 0,this.accounts=[],this.init(t),this.accounts||(this.accounts=[])}return Object(q.a)(e,[{key:"init",value:function(e){var t=this;e&&(this.active=e.active?new re(e.active):void 0,this.mnemonic=e.mnemonic,e.accounts&&Array.isArray(e.accounts)&&e.accounts.forEach((function(e){t.accounts.push(new re(e))})))}}]),e}();function ie(e,t){var n=t.type,r=t.payload;switch(n){case W.UPDATE:var a=r.wallet;return Object(y.a)(Object(y.a)({},e),{wallet:a});case W.ERROR:return{error:r.error,onError:e.onError}}}!function(e){e[e.UPDATE=0]="UPDATE",e[e.ERROR=1]="ERROR"}(W||(W={}));var ce,oe,se,ue,le,de,he,fe=i.a.createContext(void 0),ve=function(){var e=i.a.useContext(fe);if(!e)throw new Error("Component rendered outside the provider tree");return e},be=function(e){var t=new ne,n=function(e){var t=Object(a.useReducer)(ie,{wallet:e}),n=Object(_.a)(t,2),r=n[0],i=n[1],c=r.wallet,o=r.error;return{setWallet:Object(a.useCallback)((function(e){i({type:W.UPDATE,payload:{wallet:e}})}),[]),wallet:c,setError:Object(a.useCallback)((function(e){i({type:W.ERROR,payload:{error:e}})}),[]),error:o}}(t.getWallet()),r={setWallet:n.setWallet,wallet:n.wallet,setError:n.setError,error:n.error,walletManager:t};return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(fe.Provider,{value:r,children:e.children})})},je=Object(f.a)((function(e){return{root:{minWidth:275},quota:{color:e.palette.grey[500]},subtitle:{fontWeight:250},unit:{fontSize:10,display:"inline",color:e.palette.grey[500]},chip:{margin:10}}})),pe=function(e){var t,n=je(),r=J(),i=X(r,e.address),c=i.quota,o=i.fetchQuota,s=function(e,t){var n=Object(a.useState)(new Q.a),r=Object(_.a)(n,2),i=r[0],c=r[1],o=function(){var n=Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!t){n.next=6;break}return n.next=4,e.provider.vite.getBalanceByAccount(t);case 4:r=n.sent,c(r);case 6:n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),c(new Q.a);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){o()}),[e]),{balance:i,fetchBalance:o,setBalance:c}}(r,e.address),u=s.balance,h=s.fetchBalance;Object(a.useEffect)((function(){var t=setInterval(Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.address){t.next=5;break}return t.next=3,h();case 3:return t.next=5,o();case 5:case"end":return t.stop()}}),t)}))),1e3);return function(){clearInterval(t)}}));var f;return Object(S.jsxs)(v.a,{children:[Object(S.jsx)(b.a,{children:Object(S.jsxs)(j.a,{children:[Object(S.jsxs)(p.a,{children:[Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:e.title}),Object(S.jsx)(x.a,{className:n.quota,align:"center",colSpan:3,children:"Quota"})]}),Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{className:n.subtitle,children:"Balance"}),Object(S.jsx)(x.a,{className:n.subtitle,align:"right",children:"Current"}),Object(S.jsx)(x.a,{className:n.subtitle,align:"right",children:"Max"}),Object(S.jsx)(x.a,{className:n.subtitle,align:"right",children:"Staked"})]})]}),Object(S.jsx)(O.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsxs)(x.a,{children:[u.amountFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"VITE"})]}),Object(S.jsxs)(x.a,{align:"right",children:[c.currentQuotaFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"UT"})]}),Object(S.jsxs)(x.a,{align:"right",children:[c.maxQuotaFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"UT"})]}),Object(S.jsxs)(x.a,{align:"right",children:[c.stakeAmountFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"VITE"})]})]})})]})}),Object(S.jsx)(k.a,{title:null!==(t=e.address)&&void 0!==t?t:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)(w.a,{className:n.chip,size:"small",label:(f=e.address,H.a.truncateStringInTheMiddle(f,15,10))})})]})},me=n(189),xe=function(e){var t,n,r=i.a.useState(!1),a=Object(_.a)(r,2),c=a[0],o=a[1],s=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),t.prev=1,t.next=4,e.callbackFn();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log(t.t0);case 9:o(!1);case 10:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(){return t.apply(this,arguments)}}();return Object(S.jsx)(me.a,{size:null!==(t=e.size)&&void 0!==t?t:"small",variant:null!==(n=e.variant)&&void 0!==n?n:"contained",color:e.color,onClick:s,disabled:c,autoFocus:e.autoFocus,children:e.children})},Oe=n(37),ge=n(38),ke=ge.a.div(ce||(ce=Object(Oe.a)(["\n  padding-bottom: ",";\n  padding-top: 10px;\n  padding-left: 24px;\n  padding-right: 24px;\n  text-align: right;\n"])),(function(e){return e.paddingBottomSmall?"10px":"30px"})),we=function(){return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(ke,{paddingBottomSmall:!0,children:Object(S.jsxs)(g.a,{children:["v","0.0.1"]})})})},ye=n(200),_e=n(201),Se=n(196),Ae=n(212),qe=n(190),Re=n(191),Ce=n(192),Ne=n(215),Fe=n(211),Be=Object(f.a)((function(e){return Object(Ae.a)({formControl:{margin:e.spacing(1),minWidth:200,"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:e.palette.common.white},"&:hover fieldset":{borderColor:e.palette.common.white}},"& .MuiSelect-root":{color:e.palette.common.white},"& .MuiSvgIcon-root":{color:e.palette.common.white}},selectEmpty:{marginTop:e.spacing(2)}})})),Ee=function(){var e,t,n=Be(),r=ve(),a=r.wallet;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(qe.a,{"aria-label":"add",onClick:function(){r.walletManager.addAccount(),r.setWallet(r.walletManager.getWallet())},children:Object(S.jsx)(Re.a,{style:{color:"white"},children:"add_circle_outline"})}),Object(S.jsxs)(Ce.a,{variant:"outlined",className:n.formControl,size:"small",children:[Object(S.jsx)(Ne.a,{id:"select-address-label"}),Object(S.jsx)(Fe.a,{labelId:"select-address-label",id:"select-address-label",value:null===a||void 0===a||null===(e=a.active)||void 0===e?void 0:e.address,onChange:function(e){console.log(e.target.value);var t=r.walletManager.getAccountByAddress(e.target.value);t&&r.walletManager.setActiveAccount(t)&&r.setWallet(r.walletManager.getWallet())},children:null===a||void 0===a||null===(t=a.accounts)||void 0===t?void 0:t.map((function(e){return Object(S.jsx)(Se.a,{value:e.address,children:(t=e.address,H.a.truncateStringInTheMiddle(t,10,5))},e.address);var t}))})]})]})},De=n(150),Ie=n(148),Qe=n(117),He=n(217),Te=Object(f.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),Me=function(){var e=Te(),t=i.a.useState(!1),n=Object(_.a)(t,2),r=n[0],c=n[1],o=i.a.useState(""),u=Object(_.a)(o,2),l=u[0],d=u[1],h=ve(),f=Object(s.b)().enqueueSnackbar,v=h.setWallet;Object(a.useEffect)((function(){r&&console.log("login modal opened")}),[r]);return Object(S.jsxs)("div",{children:[Object(S.jsx)(me.a,{color:"inherit",onClick:function(){c(!0)},children:"Login"}),Object(S.jsx)(De.a,{className:e.modal,open:r,onClose:function(){c(!1)},closeAfterTransition:!0,BackdropComponent:Ie.a,BackdropProps:{timeout:500},children:Object(S.jsx)(Qe.a,{in:r,children:Object(S.jsxs)("div",{className:e.paper,children:[Object(S.jsx)(He.a,{id:"outlined-full-width",label:"Enter your mnemonic",placeholder:"...",fullWidth:!0,margin:"normal",variant:"outlined",value:l,onChange:function(e){var t=e.target.value;d(t)}}),Object(S.jsx)(me.a,{onClick:function(){var e=h.walletManager.createWallet(l);e?v(e):f("Invalid mnemonic")},children:"Login"})]})})})]})},We=n(197),Le=n(198),Pe=(Object(f.a)({root:{minWidth:275,minHeight:170},title:{fontSize:14},unit:{marginLeft:5}}),Object(f.a)({root:{minWidth:275,minHeight:211,textAlign:"center"},title:{fontSize:14,marginBottom:10},blockHeight:{marginTop:15},chip:{marginTop:15}})),Ue=function(){var e=Pe(),t=J(),n=function(e){var t=Object(a.useState)(I.a.InitialNetworkBlockHeight),n=Object(_.a)(t,2),r=n[0],i=n[1],c=new $.a,o=function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.provider.vite.getSnapshotChainHeightAsync();case 3:n=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),n=I.a.InitialNetworkBlockHeight;case 9:i(n),e.provider.networkStore.blockHeight=n,c.next(n);case 12:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){o()}),[e]),{blockHeight:r,blockHeightSubject:c,fetchBlockHeight:o}}(t),r=n.blockHeight,i=n.fetchBlockHeight;Object(a.useEffect)((function(){var e=setInterval(Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:case"end":return e.stop()}}),e)}))),1e3);return function(){clearInterval(e)}}));var c=t.provider.networkStore.network;return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(We.a,{className:e.root,children:Object(S.jsxs)(Le.a,{children:[Object(S.jsx)(g.a,{className:e.title,color:"textSecondary",children:"Network"}),Object(S.jsx)(w.a,{size:"small",label:null===c||void 0===c?void 0:c.name})," / ",Object(S.jsx)(w.a,{size:"small",label:null===c||void 0===c?void 0:c.networkId}),Object(S.jsx)(g.a,{className:e.blockHeight,variant:"h5",component:"h2",children:r}),Object(S.jsx)(g.a,{color:"textSecondary",children:"Block height"}),Object(S.jsx)(w.a,{className:e.chip,size:"small",label:null===c||void 0===c?void 0:c.url})]})})})},ze=Object(f.a)((function(e){return Object(Ae.a)({formControl:{margin:e.spacing(1),"& .MuiSelect-root":{color:e.palette.common.white},"& .MuiSvgIcon-root":{color:e.palette.common.white}},selectEmpty:{marginTop:e.spacing(2)}})})),Ve=function(e){var t=ze(),n=e.networkStore.networks,r=Object(a.useState)(e.networkStore.network),i=Object(_.a)(r,2),c=i[0],o=i[1];return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(Ce.a,{variant:"outlined",className:t.formControl,size:"small",children:[Object(S.jsx)(Ne.a,{id:"select-network-label"}),Object(S.jsx)(Fe.a,{labelId:"select-network-label",id:"select-network-label",value:null===c||void 0===c?void 0:c.id,onChange:function(t){console.log(t.target.value);var r=n.find((function(e){return e.id===t.target.value}));r&&(e.networkStore.network=r,o(r)),window.location.reload()},children:n.map((function(e){return Object(S.jsx)(Se.a,{value:e.id,children:e.name},e.id)}))})]})})},Ze=ge.a.div(oe||(oe=Object(Oe.a)(["\n  flex-grow: 1;\n"]))),Ge=Object(ge.a)(g.a)(se||(se=Object(Oe.a)(["\n  flex-grow: 1;\n  margin-left: 10px !important;\n"]))),Ke=function(e){var t=ve(),n=new Z,r=t.wallet;return Object(S.jsx)(Ze,{children:Object(S.jsx)(ye.a,{position:"static",children:Object(S.jsxs)(_e.a,{children:[Object(S.jsx)("img",{src:"./icon_white.png",alt:"logo",width:"30"}),Object(S.jsx)(Ge,{variant:"h6",children:"Vite Quota Bank"}),Object(S.jsx)(Ve,{networkStore:n}),(null===r||void 0===r?void 0:r.active)&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Ee,{}),Object(S.jsx)(me.a,{color:"inherit",onClick:function(){t.walletManager.removeWallet(),t.setWallet(t.walletManager.getWallet()),n.clear(),window.location.reload()},children:"Logout"})]}),!(null===r||void 0===r?void 0:r.active)&&Object(S.jsx)(Me,{})]})})})},Je=n(78),Ye=n(202),Xe=ge.a.div(ue||(ue=Object(Oe.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  align-items: center;\n  padding-bottom: 15px;\n  padding-top: 30px;\n  overflow: auto;\n  overflow-x: hidden;\n"]))),$e=ge.a.div(le||(le=Object(Oe.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]))),et=function(e){var t=e.children,n=Object(Je.a)(e,["children"]);return Object(S.jsx)(Xe,Object(y.a)(Object(y.a)({},n),{},{children:Object(S.jsx)(Ye.a,{maxWidth:"lg",children:Object(S.jsx)($e,{children:t})})}))},tt=ge.a.div(de||(de=Object(Oe.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n"]))),nt=function(e){var t=e.children,n=Object(Je.a)(e,["children"]);return Object(S.jsx)(tt,Object(y.a)(Object(y.a)({},n),{},{children:t}))},rt=function(e){var t,n=null!==(t=e.defaultValue)&&void 0!==t?t:"-";return Object(S.jsx)(S.Fragment,{children:function(){var t;if(e.value&&e.value.length>e.maxLength){var r=H.a.truncateString(e.value,e.maxLength);return Object(S.jsx)(k.a,{title:e.value,placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)("span",{children:null!==r&&void 0!==r?r:n})})}return Object(S.jsx)("span",{children:null!==(t=e.value)&&void 0!==t?t:n})}()})},at=n(76),it=n.n(at),ct=Object(f.a)((function(e){return{root:{width:"100%"},title:{fontWeight:500,marginBottom:20},refreshButton:{float:"right"}}})),ot=function(){var e,t,n=ct(),i=J(),c=i.account,o=i.provider.emitter,s=Object(a.useState)(new Q.e),u=Object(_.a)(s,2),h=u[0],f=u[1],k=Object(a.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(new Q.e),!i.account){e.next=12;break}return e.prev=2,e.next=5,i.provider.bank.getRequestByAddress(i.account);case 5:t=e.sent,f(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),f(new Q.e);case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),[i,f]);return Object(a.useEffect)((function(){var e=function(e){c===e.address&&(console.log("Handle QuotaRequestUpdated",e.address),f(e))},t=function(e){c===e&&(console.log("Handle QuotaRequestDeleted",e),f(new Q.e))};return o.on(r.QuotaRequestUpdated,e),o.on(r.QuotaRequestDeleted,t),k(),function(){console.log("AccountQuotaRequestTable disposed"),o.off(r.QuotaRequestUpdated,e),o.off(r.QuotaRequestDeleted,t)}}),[c,o,k,f]),Object(a.useEffect)((function(){var e=function(e){var t=new Q.e(h);t.update(e),h.equals(t)||(console.log("AccountQuotaRequestTable changed",h.address,e),f(t))};return o.on(r.NetworkBlockHeight,e),function(){o.off(r.NetworkBlockHeight,e)}}),[o,h,f]),Object(S.jsxs)("div",{className:n.root,children:[Object(S.jsxs)(g.a,{className:n.title,children:["My Quota Request",Object(S.jsx)(qe.a,{className:n.refreshButton,"aria-label":"refresh",onClick:k,children:Object(S.jsx)(it.a,{fontSize:"small"})})]}),Object(S.jsx)(v.a,{children:Object(S.jsx)(b.a,{children:Object(S.jsxs)(j.a,{children:[Object(S.jsx)(p.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:"Note"}),Object(S.jsx)(x.a,{children:"Amount"}),Object(S.jsx)(x.a,{children:"Expected Snapshot Height"}),Object(S.jsx)(x.a,{children:"Expected Due Date"}),Object(S.jsx)(x.a,{children:"Status"})]})}),Object(S.jsx)(O.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:Object(S.jsx)(rt,{value:h.note,maxLength:24})}),Object(S.jsx)(x.a,{children:null!==(e=null===h||void 0===h?void 0:h.amountFormatted)&&void 0!==e?e:"-"}),Object(S.jsx)(x.a,{children:null!==(t=null===h||void 0===h?void 0:h.expirationHeight)&&void 0!==t?t:"-"}),Object(S.jsx)(x.a,{children:Object(S.jsx)(jt,{quotaRequest:h})}),Object(S.jsx)(x.a,{children:(null===h||void 0===h?void 0:h.status)?Object(S.jsx)(w.a,{size:"small",label:h.status}):"-"})]})})]})})})]})},st=n(203),ut=n(204),lt=n(205),dt=n(206),ht=n(207),ft=n(28),vt=Object(f.a)((function(e){return{root:{display:"flex",width:"100%"},noteInput:{flexGrow:1,marginRight:20}}})),bt=function(){var e=vt(),t=i.a.useState(!1),n=Object(_.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),u=Object(_.a)(o,2),h=u[0],f=u[1],v=J().provider,b=Object(s.b)().enqueueSnackbar,j=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.bank.createRequest(h);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),b(ft.a.formatSnackbarMessage(e.t0));case 8:c(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),p=function(){c(!1)};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("form",{className:e.root,noValidate:!0,autoComplete:"off",children:[Object(S.jsx)(He.a,{className:e.noteInput,size:"small",label:"Request note",variant:"outlined",value:h,onChange:function(e){return f(e.target.value)}}),Object(S.jsx)(me.a,{variant:"contained",color:"primary",onClick:function(){c(!0)},children:"Request Quota"})]}),Object(S.jsxs)(st.a,{open:r,onClose:p,children:[Object(S.jsx)(ut.a,{children:"Confirm quota request"}),Object(S.jsx)(lt.a,{children:Object(S.jsx)(dt.a,{children:"You will receive quota as soon as the Vite Quota Bank accepts the request. Please note that this is a manual operation, hence some delays could be associated."})}),Object(S.jsxs)(ht.a,{children:[Object(S.jsx)(me.a,{color:"primary",onClick:p,children:"Cancel"}),Object(S.jsx)(xe,{color:"primary",callbackFn:j,children:"Confirm"})]})]})]})},jt=function(e){return Object(S.jsx)(S.Fragment,{children:function(){var t,n,r,a,i,c,o,s;return(null===e||void 0===e||null===(t=e.quotaRequest)||void 0===t?void 0:t.isExpired)?(null===e||void 0===e||null===(n=e.quotaRequest)||void 0===n?void 0:n.amount)?Object(S.jsx)(k.a,{title:null!==(r=null===e||void 0===e||null===(a=e.quotaRequest)||void 0===a?void 0:a.expirationDateFormatted)&&void 0!==r?r:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)("span",{children:"Staking expired!"})}):Object(S.jsx)(k.a,{title:null!==(i=null===e||void 0===e||null===(c=e.quotaRequest)||void 0===c?void 0:c.expirationDateFormatted)&&void 0!==i?i:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)("span",{children:"Request has expired!"})}):Object(S.jsx)("span",{children:null!==(o=null===e||void 0===e||null===(s=e.quotaRequest)||void 0===s?void 0:s.expirationDateFormatted)&&void 0!==o?o:"-"})}()})},pt=n(112),mt=n.n(pt),xt=n(195),Ot=n(147),gt=n(208),kt=function(e){var t=Object(s.b)().enqueueSnackbar,n=function(){var n=Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.item.address){n.next=7;break}return n.next=4,e.bank.deleteRequest(e.item.address);case 4:e.closeFn(),n.next=8;break;case 7:throw new Error("No address provided.");case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),t(ft.a.formatSnackbarMessage(n.t0));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(st.a,{open:e.open,onClose:e.closeFn,children:[Object(S.jsx)(ut.a,{children:"Confirm deletion"}),Object(S.jsx)(lt.a,{children:Object(S.jsxs)(xt.a,{children:[Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Address",secondary:e.item.address})}),Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Note",secondary:e.item.note})})]})}),Object(S.jsxs)(ht.a,{children:[Object(S.jsx)(me.a,{color:"primary",onClick:e.closeFn,children:"Cancel"}),Object(S.jsx)(xe,{color:"secondary",callbackFn:n,autoFocus:!0,children:"Delete"})]})]})})},wt=Object(f.a)((function(e){return{form:{width:"100%"},durationInput:{float:"right"}}})),yt=function(e){var t=wt(),n=Object(s.b)().enqueueSnackbar,r=Object(a.useState)(""),i=Object(_.a)(r,2),c=i[0],o=i[1],u=Object(a.useState)(""),h=Object(_.a)(u,2),f=h[0],v=h[1],b=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.item.address){t.next=7;break}return t.next=4,e.bank.stakeRequest(e.item.address,Number.parseInt(c),Number.parseInt(f));case 4:e.closeFn(),t.next=8;break;case 7:throw new Error("No address provided.");case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),n(ft.a.formatSnackbarMessage(t.t0));case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(st.a,{open:e.open,onClose:e.closeFn,children:[Object(S.jsx)(ut.a,{children:"Confirm quota staking"}),Object(S.jsxs)(lt.a,{children:[Object(S.jsxs)(xt.a,{children:[Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Address",secondary:e.item.address})}),Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Note",secondary:e.item.note})})]}),Object(S.jsxs)("form",{className:t.form,autoComplete:"off",children:[Object(S.jsx)(He.a,{autoFocus:!0,margin:"dense",label:"Amount",type:"number",value:c,inputProps:{min:1},onChange:function(e){return o(e.target.value)}}),Object(S.jsx)(He.a,{margin:"dense",label:"Duration (blocks)",type:"number",className:t.durationInput,value:f,inputProps:{min:1},onChange:function(e){return v(e.target.value)}})]})]}),Object(S.jsxs)(ht.a,{children:[Object(S.jsx)(me.a,{color:"primary",onClick:e.closeFn,children:"Cancel"}),Object(S.jsx)(xe,{color:"primary",callbackFn:b,autoFocus:!0,children:"Confirm"})]})]})})},_t=function(e){var t=Object(s.b)().enqueueSnackbar,n=function(){var n=Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.item.address){n.next=7;break}return n.next=4,e.bank.withdrawRequest(e.item.address);case 4:e.closeFn(),n.next=8;break;case 7:throw new Error("No address provided.");case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),t(ft.a.formatSnackbarMessage(n.t0));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(st.a,{open:e.open,onClose:e.closeFn,children:[Object(S.jsx)(ut.a,{children:"Confirm withdraw"}),Object(S.jsx)(lt.a,{children:Object(S.jsxs)(xt.a,{children:[Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Address",secondary:e.item.address})}),Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Note",secondary:e.item.note})}),Object(S.jsx)(Ot.a,{children:Object(S.jsx)(gt.a,{primary:"Amount",secondary:e.item.amountFormatted})})]})}),Object(S.jsxs)(ht.a,{children:[Object(S.jsx)(me.a,{color:"primary",onClick:e.closeFn,children:"Cancel"}),Object(S.jsx)(xe,{color:"primary",callbackFn:n,autoFocus:!0,children:"Confirm"})]})]})})};!function(e){e.Stake="STAKE",e.Withdraw="WITHDRAW",e.Delete="DELETE"}(he||(he={}));var St=Object(f.a)((function(e){return{refreshButton:{float:"right"},stakeButton:{marginRight:20}}})),At=function(e){var t,n,i,c=St(),o=e.context.provider.emitter,s=Object(a.useState)(e.item),u=Object(_.a)(s,2),l=u[0],d=u[1];Object(a.useEffect)((function(){var e=function(e){var t=new Q.e(l);t.update(e),l.equals(t)||(console.log("BankQuotaRequest changed",l.address,e),d(t))},t=function(e){l.address===e.address&&(console.log("Handle QuotaRequestUpdated",e.address),d(e))};return o.on(r.NetworkBlockHeight,e),o.on(r.QuotaRequestUpdated,t),function(){o.off(r.NetworkBlockHeight,e),o.off(r.QuotaRequestUpdated,t)}}),[o,l,d]);var h,f;return Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:Object(S.jsx)(k.a,{title:null!==(t=l.address)&&void 0!==t?t:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)(w.a,{size:"small",label:(f=l.address,H.a.truncateStringInTheMiddle(f,10,5))})})}),Object(S.jsx)(x.a,{children:Object(S.jsx)(rt,{value:l.note,maxLength:24})}),Object(S.jsx)(x.a,{children:null!==(n=l.amountFormatted)&&void 0!==n?n:"-"}),Object(S.jsx)(x.a,{children:null!==(i=l.expirationHeight)&&void 0!==i?i:"-"}),Object(S.jsx)(x.a,{children:Object(S.jsx)(jt,{quotaRequest:l})}),Object(S.jsx)(x.a,{align:"right",children:e.context.provider.networkStore.blockHeight!==I.a.InitialNetworkBlockHeight&&Object(S.jsxs)("div",{children:[(h=l,H.a.isNullOrDefault(h.amount,I.a.DefaultZeroString)&&Object(S.jsx)(me.a,{size:"small",variant:"contained",color:"primary",className:c.stakeButton,onClick:function(){e.handleClickOpenFn(he.Stake,l)},children:"Stake"})),function(e){return e.amount&&e.amount!==I.a.DefaultZeroString&&!e.isExpired}(l)&&Object(S.jsx)(w.a,{size:"small",label:"Staked"}),function(e){return e.amount&&e.amount!==I.a.DefaultZeroString&&e.isExpired}(l)&&Object(S.jsx)(me.a,{size:"small",variant:"outlined",onClick:function(){e.handleClickOpenFn(he.Withdraw,l)},children:"Withdraw"}),function(e){return H.a.isNullOrDefault(e.amount,I.a.DefaultZeroString)}(l)&&Object(S.jsx)(qe.a,{"aria-label":"delete",onClick:function(){e.handleClickOpenFn(he.Delete,l)},children:Object(S.jsx)(mt.a,{fontSize:"small"})})]})})]})},qt=n(86),Rt=Object(f.a)((function(e){return{root:{width:"100%"},title:{fontWeight:500,marginBottom:20},refreshButton:{float:"right"},stakeButton:{marginRight:20}}})),Ct=function(){var e=Rt(),t=J(),n=t.provider.emitter,c=function(e){var t=[],n=Object(a.useState)(!1),r=Object(_.a)(n,2),i=r[0],c=r[1],o=Object(a.useState)(t),s=Object(_.a)(o,2),u=s[0],h=s[1],f=function(){var n=Object(d.a)(l.a.mark((function n(){var r,a,i,o,s,u=arguments;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u.length>0&&void 0!==u[0]&&u[0],c(!0),console.log("fetchQuotaRequests"),h([]),n.prev=4,n.next=7,e.provider.bank.getRequests();case 7:r=n.sent,a=[],i=0;case 10:if(!(i<r.length)){n.next=25;break}return o=r[i],n.prev=12,n.next=15,e.provider.bank.getRequestByAddress(o);case 15:s=n.sent,a.unshift(s),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(12),console.log(n.t0);case 22:i++,n.next=10;break;case 25:h(a),n.next=32;break;case 28:n.prev=28,n.t1=n.catch(4),console.log(n.t1),h(t);case 32:c(!1);case 33:case"end":return n.stop()}}),n,null,[[4,28],[12,19]])})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log("useQuotaRequests"),f(!0)}),[e]),{isLoading:i,quotaRequests:u,fetchQuotaRequests:f,setQuotaRequests:h}}(t),o=c.isLoading,s=c.quotaRequests,u=c.fetchQuotaRequests,h=c.setQuotaRequests,f=i.a.useState(new Q.e),k=Object(_.a)(f,2),w=k[0],y=k[1],A=i.a.useState(!1),q=Object(_.a)(A,2),R=q[0],C=q[1],N=i.a.useState(!1),F=Object(_.a)(N,2),B=F[0],E=F[1],D=i.a.useState(!1),I=Object(_.a)(D,2),H=I[0],T=I[1];console.log("render BankQuotaRequestTable",t.provider.networkStore.blockHeight),Object(a.useEffect)((function(){var e=function(e){console.log("Handle QuotaRequestUpdated",e.address);var t=s.findIndex((function(t){return t.address===e.address}));if(t>=0){var n=Object(qt.a)(s);n[t]=e,h(n)}else{var r=[e].concat(Object(qt.a)(s));h(r)}},t=function(e){console.log("Handle QuotaRequestDeleted",e);var t=s.filter((function(t){return t.address!==e}));t.length<s.length&&h(t)};return n.on(r.QuotaRequestUpdated,e),n.on(r.QuotaRequestDeleted,t),function(){console.log("AccountQuotaRequestTable disposed"),n.off(r.QuotaRequestUpdated,e),n.off(r.QuotaRequestDeleted,t)}}),[n,s,h]);var M=function(e,t){switch(y(t),e){case he.Stake:C(!0);break;case he.Withdraw:E(!0);break;case he.Delete:T(!0)}},W=function(){C(!1),E(!1),T(!1)};return Object(S.jsxs)("div",{className:e.root,children:[Object(S.jsxs)(g.a,{className:e.title,children:["Bank Quota Requests",Object(S.jsx)(qe.a,{className:e.refreshButton,"aria-label":"refresh",onClick:function(){u(!0)},children:Object(S.jsx)(it.a,{fontSize:"small"})})]}),o?Object(S.jsx)(g.a,{variant:"caption",children:"Loading..."}):Object(S.jsx)(v.a,{children:Object(S.jsx)(b.a,{children:Object(S.jsxs)(j.a,{children:[Object(S.jsx)(p.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:"Address"}),Object(S.jsx)(x.a,{children:"Note"}),Object(S.jsx)(x.a,{children:"Amount"}),Object(S.jsx)(x.a,{children:"Expected Snapshot Height"}),Object(S.jsx)(x.a,{children:"Expected Due Date"}),Object(S.jsx)(x.a,{align:"center",children:"Action"})]})}),Object(S.jsx)(O.a,{children:s&&s.length>0&&s.map((function(e){return Object(S.jsx)(At,{context:t,item:e,handleClickOpenFn:M},e.address)}))})]})})}),Object(S.jsx)(kt,{item:w,bank:t.provider.bank,open:H,closeFn:W}),Object(S.jsx)(yt,{item:w,bank:t.provider.bank,open:R,closeFn:W}),Object(S.jsx)(_t,{item:w,bank:t.provider.bank,open:B,closeFn:W})]})},Nt=function(e){var t=J();return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.provider.bank.getOwnerAsync();case 2:n=e.sent,console.log("Bank owner:",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(nt,{children:[Object(S.jsx)(Ke,{}),Object(S.jsx)(et,{children:Object(S.jsxs)(h.a,{container:!0,spacing:3,children:[Object(S.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(S.jsx)(pe,{title:"My Account",address:t.account})}),Object(S.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(S.jsx)(Ue,{})}),Object(S.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(S.jsx)(pe,{title:"Bank",address:I.a.BankContractAddress})}),Object(S.jsx)(h.a,{item:!0,xs:12,children:Object(S.jsx)(bt,{})}),Object(S.jsx)(h.a,{item:!0,xs:12,children:Object(S.jsx)(ot,{})}),Object(S.jsx)(h.a,{item:!0,xs:12,children:Object(S.jsx)(Ct,{})})]})}),Object(S.jsx)(we,{})]})})},Ft=function(){return Object(S.jsx)(s.a,{maxSnack:3,children:Object(S.jsx)(be,{children:Object(S.jsx)(Y,{children:Object(S.jsx)(Nt,{})})})})},Bt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,218)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))},Et=n(209),Dt=n(113),It=Object(Dt.a)();o.a.render(Object(S.jsx)(Et.a,{theme:It,children:Object(S.jsx)(Ft,{})}),document.getElementById("root")),Bt()},15:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return h}));var r=n(10),a=n(13),i=n(14),c=n(39),o=n(23),s=n(59),u=n.n(s),l=function(){function e(){Object(r.a)(this,e),u.a.locale(navigator.language)}return Object(a.a)(e,[{key:"setLocale",value:function(e){u.a.locale(e)}},{key:"get",value:function(){return u()()}},{key:"getFromUnix",value:function(e){return u.a.unix(e)}},{key:"getLocal",value:function(e){return u.a.utc(e).local()}},{key:"getLocalTime",value:function(e){return this.getLocal(e).format("LTS")}},{key:"getLocalDate",value:function(e){return this.getLocal(e).format("L")}},{key:"getLocalFormatted",value:function(e){return this.getLocalTime(e)+" "+this.getLocalDate(e)}},{key:"getLocalReverseFormatted",value:function(e){return this.getLocalDate(e)+" "+this.getLocalTime(e)}}]),e}(),d=function(){function e(){Object(r.a)(this,e),this.moment=void 0,this.moment=new l}return Object(a.a)(e,[{key:"update",value:function(e,t){if(null===e||void 0===e?void 0:e.expirationHeight){if(e.isExpired=o.a.isExpired(e.expirationHeight,t),!e.expirationDate&&t&&t!==i.a.InitialNetworkBlockHeight){var n=Number.parseInt(c.a.minus(e.expirationHeight,t));e.expirationDate=this.moment.get().add(n,"s").toDate(),e.expirationDateFormatted=this.moment.getLocalReverseFormatted(e.expirationDate)}e.status="Unknown",e.isExpired?e.status="Expired":e.amount?e.status="Active":e.status="Pending"}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();d.instance=void 0;var h,f=n(28),v=function(){function e(t){Object(r.a)(this,e),this.address=void 0,this.contractName=void 0,this.binary=void 0,this.offChain=void 0,this.abi=void 0,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){e&&(this.contractName=e.contractName,this.binary=e.binary,this.offChain=e.offChain,this.abi=e.abi)}}]),e}(),b=function(){function e(t){Object(r.a)(this,e),this.amount=i.a.DefaultZeroString,this.amountFormatted=i.a.DefaultZeroString,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){if(null===e||void 0===e?void 0:e.balanceInfoMap){var t=e.balanceInfoMap[i.a.ViteTokenId];this.amount=t.balance,this.amountFormatted=f.a.formatAmount(t.balance)}}}]),e}(),j=function(){function e(t){Object(r.a)(this,e),this.id=void 0,this.networkId=void 0,this.name=void 0,this.url=void 0,this.mock=!1,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){var t;e&&(this.id=e.id,this.networkId=e.networkId,this.name=e.name,this.url=e.url,this.mock=null!==(t=e.mock)&&void 0!==t&&t)}}]),e}(),p=function(){function e(t){Object(r.a)(this,e),this.currentQuota=i.a.DefaultZeroString,this.currentQuotaFormatted=i.a.DefaultZeroString,this.maxQuota=i.a.DefaultZeroString,this.maxQuotaFormatted=i.a.DefaultZeroString,this.stakeAmount=i.a.DefaultZeroString,this.stakeAmountFormatted=i.a.DefaultZeroString,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){e&&(this.currentQuota=e.currentQuota,this.currentQuotaFormatted=f.a.formatQuota(e.currentQuota),this.maxQuota=e.maxQuota,this.maxQuotaFormatted=f.a.formatQuota(e.maxQuota),this.stakeAmount=e.stakeAmount,this.stakeAmountFormatted=f.a.formatAmount(e.stakeAmount))}}]),e}(),m=function(){function e(t){Object(r.a)(this,e),this.address=void 0,this.note=void 0,this.amount=void 0,this.amountFormatted=void 0,this.expirationHeight=void 0,this.expirationDate=void 0,this.expirationDateFormatted=void 0,this.isExpired=!1,this.status=void 0,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){e&&(this.address=e.address,this.note=e.note,this.amount=e.amount,this.amountFormatted=f.a.formatAmount(e.amount),this.expirationHeight=e.expirationHeight,this.expirationDate=e.expirationDate,this.expirationDateFormatted=e.expirationDateFormatted,this.isExpired=e.isExpired,this.status=e.status)}},{key:"update",value:function(t){e.updater.update(this,t)}},{key:"equals",value:function(e){return this.address===e.address&&this.note===e.note&&this.amount===e.amount&&this.amountFormatted===e.amountFormatted&&this.expirationHeight===e.expirationHeight&&this.expirationDateFormatted===e.expirationDateFormatted&&this.isExpired===e.isExpired&&this.status===e.status}}]),e}();m.updater=d.getInstance(),function(e){e.RequestCreated="RequestCreated",e.RequestDeleted="RequestDeleted"}(h||(h={}))},23:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(10),a=n(13),i=n(39),c=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"isString",value:function(e){return"string"===typeof e||e instanceof String}},{key:"isNullOrWhitespace",value:function(t){return!e.isString(t)||(null===t||void 0===t||""===t.trim())}},{key:"isNullOrDefault",value:function(t,n){return e.isNullOrWhitespace(t)||t===n}},{key:"isExpired",value:function(e,t){return!(!e||!t)&&1===i.a.compared(t,e)}}]),e}();c.truncateString=function(e,t){return e&&t<e.length?"".concat(e.substr(0,t),"..."):e},c.truncateStringInTheMiddle=function(e,t,n){if(e&&t+n<e.length)return"".concat(e.substr(0,t),"...").concat(e.substr(e.length-n,e.length));return e}},28:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10),a=n(13),i=n(14),c=n(39),o=n(23),s=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"formatQuota",value:function(e){try{var t=c.a.toBasic(Number.parseInt(e)/i.a.QuotaPerUT,0,3);return o.a.isNullOrWhitespace(t)?void 0:t}catch(n){return"-1"}}},{key:"formatAmount",value:function(e){try{var t=c.a.toBasic(Number.parseInt(e),i.a.DefaultDecimals);return o.a.isNullOrWhitespace(t)?void 0:t}catch(n){return"-1"}}},{key:"formatSnackbarMessage",value:function(e){if(e){var t,n;if(console.log(e),o.a.isString(e))t=e;else t=e.message?e.message:(null===(n=e.error)||void 0===n?void 0:n.message)?e.error.message:JSON.stringify(e);return t.length>128?t.substr(0,128)+"...":t}return"Something went wrong."}}]),e}()},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(10),a=n(13),i=n(20),c=n.n(i),o={decimalSeparator:".",groupSeparator:"",groupSize:0,secondaryGroupSize:0,fractionGroupSeparator:"",fractionGroupSize:0},s={FORMAT:o,ROUNDING_MODE:c.a.ROUND_DOWN},u={FORMAT:{decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0},ROUNDING_MODE:c.a.ROUND_DOWN},l={FORMAT:o,ROUNDING_MODE:c.a.ROUND_CEIL};c.a.config(s);var d=c.a.clone(u),h=c.a.clone(l),f=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"compared",value:function(e,t){return e=new c.a(e),t=new c.a(t),e.comparedTo(t)}},{key:"isEqual",value:function(e,t){return e=new c.a(e),t=new c.a(t),e.isEqualTo(t)}},{key:"minus",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fix";e=new c.a(e),t=new c.a(t);var a=e.minus(t);return"fix"===r?a.toFormat(n):a.decimalPlaces(n,1).toFormat()}},{key:"plus",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fix";e=new c.a(e),t=new c.a(t);var a=e.plus(t);return"fix"===r?a.toFormat(n):a.decimalPlaces(n,1).toFormat()}},{key:"multi",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;return e=new c.a(e),t=new c.a(t),e.multipliedBy(t).toFormat(n)}},{key:"dividedToNumber",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fix";if(e=new c.a(e),t=new c.a(t),0===n)return e.dividedBy(t).integerValue().toString();var a=e.dividedBy(t);return"fix"===r?a.toFormat(n):a.decimalPlaces(n,1).toFormat()}},{key:"dividedCeil",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=new h(e),t=new h(t);var r=e.dividedBy(t);return r.toFormat(n)}},{key:"toBasic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=new c.a(10).exponentiatedBy(t);if(null===(e=new c.a(e)).c)return"";try{return e.dividedBy(r).decimalPlaces(n,1).toFormat()}catch(a){return""}}},{key:"exponentiated",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new c.a(e).exponentiatedBy(t),a=new c.a(n),i=r.plus(a);return i.toFormat()}},{key:"toMin",value:function(e,t){var n=new c.a(10).exponentiatedBy(t);if(null===(e=new c.a(e)).c)return"";try{return e.multipliedBy(n).toFormat()}catch(r){return""}}},{key:"formatNum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;t=t>=n?n:t;var r=new d(e);return r.toFormat(t)}},{key:"normalFormatNum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;t=t>=n?n:t;var r=new c.a(e);return r.toFormat(t)}},{key:"onlyFormat",value:function(e,t){var n=new d(e).toFormat();if("undefined"===typeof t)return n;var r=n.split(".")[1]||"";if(r.length>=t)return n;r.length||(n+=".");for(var a=0;a<t-r.length;a++)n+="0";return n}}]),e}()},64:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n(29),a=n(5),i=n.n(a),c=n(8),o=n(10),s=n(13),u=n(31),l=n(15),d=n(106),h=n(142).WS_RPC,f={retryTimes:10,retryInterval:5e3},v=function(){function t(){var e=this;Object(o.a)(this,t),this._provider=void 0,this._client=void 0,this._isConnected=!1,this.initAsync=function(){var t=Object(c.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e._isConnected=!1,e._provider&&e._provider.destroy(),e._provider=new h(n,6e4,f);var a=!1;e._provider.on("error",(function(t){console.log(t),a||(r(t),e._isConnected=!1)})),e._client=new u.ViteAPI(e._provider,(function(){e._isConnected=!0,console.log("ViteAPI connected to ".concat(e._provider.path)),a=!0,t()}))})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}return Object(s.a)(t,[{key:"isConnected",get:function(){return this._isConnected}},{key:"dispose",value:function(){console.log("Disposing ViteClient"),this._provider.disconnect(),this._isConnected=!1}},{key:"requestAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,a,c,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isConnected){e.next=5;break}for(r=o.length,a=new Array(r>1?r-1:0),c=1;c<r;c++)a[c-1]=o[c];return e.abrupt("return",(n=this._client).request.apply(n,[t].concat(a)));case 5:return e.abrupt("return",Promise.reject("Vite client is not ready to make requests."));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSnapshotChainHeightAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.requestAsync("ledger_getSnapshotChainHeight"));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBalanceByAccount",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestAsync("ledger_getAccountInfoByAddress",t);case 2:return n=e.sent,e.abrupt("return",new l.a(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQuotaByAccount",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestAsync("contract_getQuotaByAccount",t);case 2:return n=e.sent,e.abrupt("return",new l.d(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"callContractAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n,r,a,c,o){var s,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=u.accountBlock.createAccountBlock("callContract",{address:t.address,abi:r,methodName:n,amount:c,toAddress:o,params:a}).setProvider(this._client).setPrivateKey(t.privateKey),e.next=3,s.autoSetPreviousAccountBlock();case 3:return e.next=5,s.sign().send();case 5:return l=e.sent,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,c){return e.apply(this,arguments)}}()},{key:"callOffChainMethodAsync",value:function(){var t=Object(c.a)(i.a.mark((function t(n,r,a,c){var o,s,l,d,h,f,v,b,j;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=u.abi.encodeFunctionCall(r,c),s=e.from(o,"hex").toString("base64"),t.next=4,this.requestAsync("contract_callOffChainMethod",{selfAddr:n,offChainCode:a,data:s});case 4:if(!(l=t.sent)){t.next=13;break}for(d=e.from(l,"base64").toString("hex"),h=[],f=0;f<r.outputs.length;f++)h.push(r.outputs[f].type);if(v=u.abi.decodeParameters(h,d),b=[],v)for(j=0;j<r.outputs.length;j++)r.outputs[j].name?b.push({name:r.outputs[j].name,value:v[j]}):b.push({name:"",value:v[j]});return t.abrupt("return",b);case 13:return t.abrupt("return","");case 14:case"end":return t.stop()}}),t,this)})));return function(e,n,r,a){return t.apply(this,arguments)}}()},{key:"decodeVmLog",value:function(e,t){for(var n=e.topics,r=0;r<t.length;r++){var a=t[r];if(u.abi.encodeLogSignature(a)===n[0])if(e.data)return{topic:n[0],args:u.abi.decodeLog(a.inputs,u.utils._Buffer.from(e.data,"base64").toString("hex"),n.slice(1)),event:a.name}}}},{key:"createAddressListenerAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={addressHeightRange:{placeholder:{fromHeight:"0",toHeight:"0"}}},r=(r=JSON.stringify(n)).replace("placeholder",t),e.next=5,this._client.subscribe("createVmlogSubscription",JSON.parse(r));case 5:return a=e.sent,console.log(a),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeListener",value:function(e){this._client.unsubscribe(e)}},{key:"waitForAccountBlockAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(i.a.mark((function e(o,s){var u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=void 0,l=void 0,new d.a(Object(c.a)(i.a.mark((function e(){var c,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.requestAsync("ledger_getAccountBlockByHeight",t,n);case 3:if(c=e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:if(o=c.receiveBlockHash){e.next=9;break}return e.abrupt("return",!0);case 9:return e.next=11,a.requestAsync("ledger_getAccountBlockByHash",o);case 11:if(s=e.sent){e.next=14;break}return e.abrupt("return",!0);case 14:return u=Object(r.a)(Object(r.a)({},a.getAccountBlockStatus(s)),{},{accountBlock:s}),e.abrupt("return",!1);case 18:return e.prev=18,e.t0=e.catch(0),l=e.t0,e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))),500).start((function(){l?s(l):o(u)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getAccountBlockStatus",value:function(e){var t=this.resolveAccountBlockData(e),n="";switch(t){case 0:n="0, Execution succeed";break;case 1:n="1, Execution reverted";break;case 2:n="2, Max call depth exceeded"}return{status:t,statusTxt:n}}},{key:"resolveAccountBlockData",value:function(e){if(4!==e.blockType&&5!==e.blockType||!e.data)return 0;var t=u.utils._Buffer.from(e.data,"base64");return 33!==t.length?0:t[32]}}]),t}()}).call(this,n(137).Buffer)}},[[146,1,2]]]);
//# sourceMappingURL=main.c8d0c048.chunk.js.map