(this["webpackJsonpvite-quota-bank"]=this["webpackJsonpvite-quota-bank"]||[]).push([[0],{110:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),a=n.n(r),i=n(7),c=n(10),o=n(11),s=function(){function e(t,n){return Object(c.a)(this,e),this._taskTimer=void 0,this._taskInterval=void 0,this._task=void 0,this._callback=void 0,this._task=t,this._taskInterval=n,this}return Object(o.a)(e,[{key:"_run",value:function(){var e=this;this._taskTimer=setTimeout(Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._task){t.next=3;break}return e._onStop(),t.abrupt("return");case 3:return t.next=5,e._task();case 5:if(t.sent){t.next=8;break}return e._onStop(),t.abrupt("return");case 8:e._run();case 9:case"end":return t.stop()}}),t)}))),this._taskInterval)}},{key:"_onStop",value:function(){this._callback&&this._callback()}},{key:"start",value:function(e){this._callback=e,this._taskTimer||this._run()}},{key:"stop",value:function(){this._onStop(),this._taskTimer&&(window.clearTimeout(this._taskTimer),this._taskTimer=void 0)}}]),e}()},13:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={QuotaPerUT:21e3,DefaultDecimals:18,DefaultZeroString:"0",InitialNetworkBlockHeight:"0",ViteTokenId:"tti_5649544520544f4b454e6e40",QuotaContractAddress:"vite_0000000000000000000000000000000000000003f6af7459b9",BankContractAddress:"vite_091e12441cc09f51bb84b7950c7a4a3c44b77442eccb789f7a",NetworkStorageSpace:"VQB_NETWORK",WebWalletStorageSpace:"VQB_WEB_WALLET",SessionWalletStorageSpace:"VQB_SESSION_WALLET",DefaultMnemonic:"spell barely teach wisdom best tragic three lyrics second notable excuse hobby example tenant business midnight member canal energy evoke debate tortoise high infant"}},136:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),c=n(18),o=n.n(c),s=(n(136),n(35)),u=n(4),l=n.n(u),d=n(7),h=n(216),f=n(192),v=n(94),b=n(193),p=n(194),j=n(195),m=n(196),x=n(197),O=n(198),g=n(63),k=n(225),w=n(226),y=n(24),_=n(15),S=n(1),A=n(10),C=n(11),q=n(67),R=n(32),N=n(31),D=function(e){Object(R.a)(n,e);var t=Object(N.a)(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return n}(q.a),E=n(77),B=n.n(E);!function(e){e.NetworkBlockHeight="NetworkBlockHeight",e.QuotaRequestUpdated="QuotaRequestUpdated",e.QuotaRequestDeleted="QuotaRequestDeleted",e.ConfirmTransactionDialog="ConfirmTransactionDialog"}(r||(r={}));var F=function(e){Object(R.a)(n,e);var t=Object(N.a)(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"emitNetworkBlockHeight",value:function(e){this.emit(r.NetworkBlockHeight,e)}},{key:"emitQuotaRequestUpdated",value:function(e){this.emit(r.QuotaRequestUpdated,e)}},{key:"emitQuotaRequestDeleted",value:function(e){this.emit(r.QuotaRequestDeleted,e)}},{key:"emitConfirmTransactionDialog",value:function(e){this.emit(r.ConfirmTransactionDialog,e)}}]),n}(B.a),W=n(13),I=n(16),T=n(23),Q=function(){function e(){Object(A.a)(this,e)}return Object(C.a)(e,null,[{key:"notNull",value:function(e,t){if(null===e||void 0===e)throw new Error("Unexpected null exception. "+t)}},{key:"notNullOrWhiteSpace",value:function(e,t){if(null===e||void 0===e||""===(null===e||void 0===e?void 0:e.trim()))throw new Error("Unexpected null exception. "+t)}}]),e}(),H=function(){function e(){Object(A.a)(this,e),this._fileUtil=void 0,this._fileUtil=new U}return Object(C.a)(e,[{key:"readFileAsync",value:function(e){return this._fileUtil.readFileAsync(e)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();H.instance=void 0;var M,U=function(){function e(){Object(A.a)(this,e)}return Object(C.a)(e,[{key:"readFileAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.abrupt("return",n.text());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),L=function(){function e(t,n,r,a){var i=this;Object(A.a)(this,e),this._vite=void 0,this._emitter=void 0,this._networkStore=void 0,this._walletManager=void 0,this._contract=void 0,this._offchainMethods=new Map,this._listener=void 0,this.handleResponseAsync=function(){var e=Object(d.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){i._vite.waitForAccountBlockAsync(t,n).then((function(t){var n;0===(null===t||void 0===t?void 0:t.status)?e():r(null!==(n=null===t||void 0===t?void 0:t.statusTxt)&&void 0!==n?n:"Something went wrong.")}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.objectFromEntries=function(e){return Object.fromEntries(e.map((function(e){return[e.name,e.value]})))},this._vite=t,this._emitter=n,this._networkStore=r,this._walletManager=a}return Object(C.a)(e,[{key:"listener",get:function(){if(!this._listener)throw new Error("Listener is not defined.");return this._listener}},{key:"ensureContractExists",value:function(){var e;if(void 0===(null===(e=this._contract)||void 0===e?void 0:e.address))throw new Error("Bank contract is not defined.");return this._contract}},{key:"ensureAccountExists",value:function(){var e=this._walletManager.getActiveAccount();if(void 0===(null===e||void 0===e?void 0:e.address))throw new Error("Login and try again.");return e}},{key:"removeAddressListener",value:function(){this._listener&&this._vite.removeListener(this._listener)}},{key:"initAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,r=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.removeAddressListener(),e.next=3,H.getInstance().readFileAsync("./assets/contracts/QuotaBank.json");case 3:return n=e.sent,this._contract=new I.b(JSON.parse(n)),this._contract.address=W.a.BankContractAddress,console.log("Contract name:",null===(t=this._contract)||void 0===t?void 0:t.contractName),e.next=9,this._vite.createAddressListenerAsync(this._contract.address);case 9:this._listener=e.sent,this._listener.on((function(e){var t;if(null===(t=r._contract)||void 0===t?void 0:t.abi)for(var n=0;n<e.length;n++){var a=e[n],i=r._vite.decodeVmLog(a.vmlog,r._contract.abi);console.log(null!==i&&void 0!==i?i:a),i&&r.handleVmLogAsync(i)}else console.log("Could not decode vmlog because contract abi is not defined.")}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){console.log("Disposing BankService"),this.removeAddressListener()}},{key:"getOwnerAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ensureContractExists(),e.next=3,this._vite.callOffChainMethodAsync(t.address,this.getOffchainMethodAbi("getOwner"),t.offChain,[]);case 3:return n=e.sent,e.abrupt("return",n[0].value);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRequests",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ensureContractExists(),e.next=3,this._vite.callOffChainMethodAsync(t.address,this.getOffchainMethodAbi("getRequestors"),t.offChain,[]);case 3:return n=e.sent,e.abrupt("return",n[0].value);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRequestByAddress",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureContractExists(),e.next=3,this._vite.callOffChainMethodAsync(n.address,this.getOffchainMethodAbi("getRequest"),n.offChain,[t]);case 3:if(r=e.sent,a=new I.e(this.objectFromEntries(r)),!this.isEmptyRequest(a)){e.next=7;break}throw new Error("No request found for '".concat(t,"'."));case 7:return a.address=t,a.update(this._networkStore.blockHeight),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureContractExists(),r=this.ensureAccountExists(),e.next=4,this._vite.callContractAsync(r,"CreateRequest",n.abi,[t],W.a.DefaultZeroString,n.address);case 4:return a=e.sent,e.next=7,this.handleResponseAsync(r.address,a.height);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stakeRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"withdrawRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteRequest",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureContractExists(),r=this.ensureAccountExists(),e.next=4,this._vite.callContractAsync(r,"DeleteRequest",n.abi,[t],W.a.DefaultZeroString,n.address);case 4:return a=e.sent,e.next=7,this.handleResponseAsync(r.address,a.height);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOffchainMethodAbi",value:function(e){var t,n=this.ensureContractExists();if(this._offchainMethods.has(e)?t=this._offchainMethods.get(e):(t=n.abi.find((function(t){return"offchain"===t.type&&t.name===e})))&&this._offchainMethods.set(e,t),t)return t;throw new Error("The offchain method '".concat(e,"' does not exist.'"))}},{key:"isEmptyRequest",value:function(e){return T.a.isNullOrDefault(e.expirationHeight,W.a.DefaultZeroString)}},{key:"handleVmLogAsync",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.event!==I.f.RequestCreated){e.next=9;break}return Q.notNullOrWhiteSpace(null===(n=t.args)||void 0===n?void 0:n.addr,"vmlog.args.addr"),e.next=5,this.getRequestByAddress(null===(r=t.args)||void 0===r?void 0:r.addr);case 5:a=e.sent,this._emitter.emitQuotaRequestUpdated(a),e.next=10;break;case 9:t.event===I.f.RequestDeleted?(Q.notNullOrWhiteSpace(null===(i=t.args)||void 0===i?void 0:i.addr,"vmlog.args.addr"),this._emitter.emitQuotaRequestDeleted(null===(c=t.args)||void 0===c?void 0:c.addr)):console.log("Unknown vmlog event.");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),P=n(42),z=[new I.e({address:"vite_48e7436290e300268ed360a28704d9df9dbcbe485f7ed24cf1",expirationHeight:"1487686"}),new I.e({address:"vite_7fb28c2b8c3ee3fd5d271f632b16ef81f1f98d136445a1c1cb",expirationHeight:"1987866",note:"Twitter: 0xRomanNiklaus"}),new I.e({address:"vite_ce9499905e2dacab4972574cc4319f9b9d44020af89a239463",expirationHeight:"1587687",note:"GitHub: niklr",amount:"1500000000000000000000"}),new I.e({address:"vite_df81e81a5e552f54fccdad71aa0b951ebec6e456f9d0c69ee4",expirationHeight:"1350998",amount:"1500000000000000000000"}),new I.e({note:"Test 1324"})],V=function(e){Object(R.a)(n,e);var t=Object(N.a)(n);function n(){var e;Object(A.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).getRequests=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){setTimeout((function(){e(z.flatMap((function(e){return e.address?e.address:[]})))}),1e3)})));case 1:case"end":return e.stop()}}),e)}))),e.getRequestByAddress=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var a=z.find((function(e){return e.address===n}));null===a||void 0===a||a.update(e._networkStore.blockHeight),a?setTimeout((function(){t(a)}),100):r("Quota request for '".concat(n,"' not found."))})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.createRequest=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var a=e.ensureAccountExists();if(n)if(a.address&&z.find((function(e){return e.address===a.address})))r("Request already exists.");else{var i=new I.e({address:a.address,note:n,expirationHeight:e._networkStore.blockHeight+10});i.update(e._networkStore.blockHeight),z.push(i),t(),setTimeout((function(){e._emitter.emitQuotaRequestUpdated(i)}),500)}else setTimeout((function(){r("Request failed. Please try again later.")}),2e3)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.stakeRequest=function(){var t=Object(d.a)(l.a.mark((function t(n,r,a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){if(e.ensureAccountExists(),!r||r<=0)i("Please provide a valid amount.");else if(!a||a<=0)i("Please provide a valid duration.");else{var c=z.find((function(e){return e.address===n}));if(c){c.amount=P.a.toMin(r,W.a.DefaultDecimals),c.expirationHeight=e._networkStore.blockHeight+a;var o=new I.e(c);o.update(e._networkStore.blockHeight),t(),setTimeout((function(){e._emitter.emitQuotaRequestUpdated(o)}),500)}else i("Request does not exist.")}})));case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.withdrawRequest=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.ensureAccountExists();var a=z.find((function(e){return e.address===n}));if(a){a.amount=void 0;var i=new I.e(a);i.update(e._networkStore.blockHeight),t(),setTimeout((function(){e._emitter.emitQuotaRequestUpdated(i)}),500)}else r("Request does not exist.")})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.deleteRequest=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.ensureAccountExists();var a=z.find((function(e){return e.address===n}));if(a){var i=z.indexOf(a);i>-1&&z.splice(i,1),setTimeout((function(){t(),e._emitter.emitQuotaRequestDeleted(n)}),500)}else r("Request does not exist.")})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return n}(L),K=function(){function e(t){Object(A.a)(this,e),this._key=W.a.NetworkStorageSpace,this._emitter=void 0,this._blockHeight=void 0,this._network=void 0,this._defaultNetwork=void 0,this._networks=[new I.c({id:2,networkId:2,name:"TESTNET",rpcUrl:"wss://buidl.vite.net/gvite/ws",connectorUrl:"wss://biforst.vite.net"}),new I.c({id:3,networkId:2,name:"TESTNET+MOCK",rpcUrl:"wss://buidl.vite.net/gvite/ws",connectorUrl:"wss://biforst.vite.net",mock:!0}),new I.c({id:4,networkId:5,name:"DEBUG",rpcUrl:"ws://localhost:23457",connectorUrl:"wss://biforst.vite.net"})],this._emitter=t,this._blockHeight=W.a.InitialNetworkBlockHeight,this._defaultNetwork=this._networks[1]}return Object(C.a)(e,[{key:"blockHeight",get:function(){return this._blockHeight},set:function(e){var t;this._blockHeight=e,null===(t=this._emitter)||void 0===t||t.emitNetworkBlockHeight(e)}},{key:"network",get:function(){if(this._network)return this._network;var e;try{e=localStorage.getItem(this._key)}catch(r){console.error(r)}if(!e)return this.defaultNetwork;try{var t,n=new I.c(JSON.parse(e));return this._network=this._networks.find((function(e){return e.id===n.id})),null!==(t=this._network)&&void 0!==t?t:this.defaultNetwork}catch(r){return console.log(r),this.defaultNetwork}},set:function(e){e?(this._network=e,localStorage.setItem(this._key,JSON.stringify(e))):(this._network=void 0,localStorage.removeItem(this._key))}},{key:"defaultNetwork",get:function(){return this._defaultNetwork}},{key:"networks",get:function(){var e;return null!==(e=this._networks)&&void 0!==e?e:[]}},{key:"getById",value:function(e){return this._networks.find((function(t){return t.id===e}))}},{key:"clear",value:function(){this._network=void 0,localStorage.removeItem(this._key)}}]),e}(),Z=n(43),G=function(){function e(t){Object(A.a)(this,e),this.emitter=void 0,this.networkStore=void 0,this.vite=void 0,this.bank=void 0,this.emitter=new F,this.networkStore=new K(this.emitter);var n=new Z.f(t);this.networkStore.network.mock?(this.vite=new D(this.emitter,n),this.bank=new V(this.vite,this.emitter,this.networkStore,t)):(this.vite=new q.a(this.emitter,n),this.bank=new L(this.vite,this.emitter,this.networkStore,t))}return Object(C.a)(e,[{key:"dispose",value:function(){console.log("Disposing ServiceProvider"),this.vite.dispose(),this.bank.dispose()}}]),e}(),J=i.a.createContext(void 0),X=function(){var e=i.a.useContext(J);if(!e)throw new Error("Component rendered outside the provider tree");return e},Y=function(e){var t=Object(a.useState)(null),n=Object(_.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)(!1),o=Object(_.a)(c,2),s=o[0],u=o[1],h=re().walletManager,f=h.getWallet(),v=Object(a.useMemo)((function(){return new G(h)}),[h]);if(Object(a.useEffect)((function(){var e,t;if(!v.networkStore.network)throw new Error("Network is not defined");var n={account:null===f||void 0===f||null===(e=f.active)||void 0===e?void 0:e.address,walletManager:h,provider:v};return console.log("ConnectedWeb3.account",null===f||void 0===f||null===(t=f.active)||void 0===t?void 0:t.address),function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("ConnectedWeb3.initAsync"),null===(t=n.provider.networkStore.network)||void 0===t?void 0:t.rpcUrl){e.next=5;break}throw new Error("Network is not defined");case 5:return e.next=7,n.provider.vite.initAsync(n.provider.networkStore.network);case 7:return e.next=9,n.provider.bank.initAsync();case 9:i(n),u(!0);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){v.dispose()}}),[f,h,v]),!r)return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(ut,{children:[Object(S.jsx)(tt,{}),Object(S.jsx)(ot,{children:Object(S.jsx)(g.a,{children:"Loading..."})}),Object(S.jsx)(Ae,{})]})});var b=Object(y.a)({},r);return Object(S.jsx)(S.Fragment,{children:s?Object(S.jsx)(J.Provider,{value:b,children:e.children}):Object(S.jsx)(S.Fragment,{})})},$=function(e,t){var n=Object(a.useState)(new I.d),r=Object(_.a)(n,2),i=r[0],c=r[1],o=function(){var n=Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!t){n.next=6;break}return n.next=4,e.provider.vite.getQuotaByAccount(t);case 4:r=n.sent,c(r);case 6:n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),c(new I.d);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){o()}),[e]),{quota:i,fetchQuota:o,setQuota:c}},ee=n(222);function te(e,t){var n=t.type,r=t.payload;switch(n){case M.UPDATE:var a=r.wallet;return Object(y.a)(Object(y.a)({},e),{wallet:a});case M.ERROR:return{error:r.error,onError:e.onError}}}!function(e){e[e.UPDATE=0]="UPDATE",e[e.ERROR=1]="ERROR"}(M||(M={}));var ne=i.a.createContext(void 0),re=function(){var e=i.a.useContext(ne);if(!e)throw new Error("Component rendered outside the provider tree");return e},ae=function(e){var t=new Z.g,n=function(e){var t=Object(a.useReducer)(te,{wallet:e}),n=Object(_.a)(t,2),r=n[0],i=n[1],c=r.wallet,o=r.error;return{setWallet:Object(a.useCallback)((function(e){i({type:M.UPDATE,payload:{wallet:e}})}),[]),wallet:c,setError:Object(a.useCallback)((function(e){i({type:M.ERROR,payload:{error:e}})}),[]),error:o}}(t.getWallet()),r=n.setWallet,i=n.setError,c=n.error;t.onSetWalletCallback=r;var o={setError:i,error:c,walletManager:t};return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(ne.Provider,{value:o,children:e.children})})},ie=Object(f.a)((function(e){return{root:{minWidth:275},quota:{color:e.palette.grey[500]},subtitle:{fontWeight:250},unit:{fontSize:10,display:"inline",color:e.palette.grey[500]},chip:{margin:10}}})),ce=function(e){var t,n=ie(),r=X(),i=$(r,e.address),c=i.quota,o=i.fetchQuota,s=function(e,t){var n=Object(a.useState)(new I.a),r=Object(_.a)(n,2),i=r[0],c=r[1],o=function(){var n=Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!t){n.next=6;break}return n.next=4,e.provider.vite.getBalanceByAccount(t);case 4:r=n.sent,c(r);case 6:n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),c(new I.a);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){o()}),[e]),{balance:i,fetchBalance:o,setBalance:c}}(r,e.address),u=s.balance,h=s.fetchBalance;Object(a.useEffect)((function(){var t=setInterval(Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.address){t.next=5;break}return t.next=3,h();case 3:return t.next=5,o();case 5:case"end":return t.stop()}}),t)}))),1e3);return function(){clearInterval(t)}}));var f;return Object(S.jsxs)(v.a,{children:[Object(S.jsx)(b.a,{children:Object(S.jsxs)(p.a,{children:[Object(S.jsxs)(j.a,{children:[Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:e.title}),Object(S.jsx)(x.a,{className:n.quota,align:"center",colSpan:3,children:"Quota"})]}),Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{className:n.subtitle,children:"Balance"}),Object(S.jsx)(x.a,{className:n.subtitle,align:"right",children:"Current"}),Object(S.jsx)(x.a,{className:n.subtitle,align:"right",children:"Max"}),Object(S.jsx)(x.a,{className:n.subtitle,align:"right",children:"Staked"})]})]}),Object(S.jsx)(O.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsxs)(x.a,{children:[u.amountFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"VITE"})]}),Object(S.jsxs)(x.a,{align:"right",children:[c.currentQuotaFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"UT"})]}),Object(S.jsxs)(x.a,{align:"right",children:[c.maxQuotaFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"UT"})]}),Object(S.jsxs)(x.a,{align:"right",children:[c.stakeAmountFormatted," ",Object(S.jsx)(g.a,{className:n.unit,children:"VITE"})]})]})})]})}),Object(S.jsx)(k.a,{title:null!==(t=e.address)&&void 0!==t?t:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)(w.a,{className:n.chip,size:"small",label:(f=e.address,T.a.truncateStringInTheMiddle(f,15,10))})})]})},oe=n(201),se=function(e){var t,n,r=i.a.useState(!1),a=Object(_.a)(r,2),c=a[0],o=a[1],s=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),t.prev=1,t.next=4,e.callbackFn();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log(t.t0);case 9:o(!1);case 10:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(){return t.apply(this,arguments)}}();return Object(S.jsx)(oe.a,{size:null!==(t=e.size)&&void 0!==t?t:"small",variant:null!==(n=e.variant)&&void 0!==n?n:"contained",color:e.color,onClick:s,disabled:c,autoFocus:e.autoFocus,children:e.children})},ue=n(202),le=n(206),de=n(204),he=n(205),fe=n(203),ve=n(188),be=i.a.forwardRef((function(e,t){return Object(S.jsx)(ve.a,Object(y.a)({direction:"up",ref:t},e))}));function pe(){var e=X().provider.emitter,t=i.a.useState(!1),n=Object(_.a)(t,2),c=n[0],o=n[1];Object(a.useEffect)((function(){var t=function(e){o(e)};return e.on(r.ConfirmTransactionDialog,t),function(){e.off(r.ConfirmTransactionDialog,t)}}),[e,o]);var s=function(){o(!1)};return Object(S.jsxs)(ue.a,{open:c,TransitionComponent:be,keepMounted:!0,onClose:s,style:{zIndex:9999},children:[Object(S.jsx)(fe.a,{children:"ViteConnect"}),Object(S.jsx)(de.a,{children:Object(S.jsx)(he.a,{children:"Please confirm transaction on VITE Wallet App"})}),Object(S.jsx)(le.a,{children:Object(S.jsx)(oe.a,{onClick:s,color:"primary",children:"Close"})})]})}var je,me,xe,Oe,ge,ke,we,ye=n(40),_e=n(41),Se=_e.a.div(je||(je=Object(ye.a)(["\n  padding-bottom: ",";\n  padding-top: 10px;\n  padding-left: 24px;\n  padding-right: 24px;\n  text-align: right;\n"])),(function(e){return e.paddingBottomSmall?"10px":"30px"})),Ae=function(){return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(Se,{paddingBottomSmall:!0,children:Object(S.jsxs)(g.a,{children:["v","0.0.3"]})})})},Ce=n(217),qe=n(218),Re=n(213),Ne=n(224),De=n(207),Ee=n(208),Be=n(209),Fe=n(227),We=n(223),Ie=Object(f.a)((function(e){return Object(Ne.a)({formControl:{margin:e.spacing(1),minWidth:200,"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:e.palette.common.white},"&:hover fieldset":{borderColor:e.palette.common.white}},"& .MuiSelect-root":{color:e.palette.common.white},"& .MuiSvgIcon-root":{color:e.palette.common.white}},selectEmpty:{marginTop:e.spacing(2)}})})),Te=function(){var e,t,n,r=Ie(),a=re().walletManager,i=a.getWallet(),c=(null===i||void 0===i||null===(e=i.active)||void 0===e?void 0:e.type)===Z.d.Web;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{hidden:!c,children:Object(S.jsx)(De.a,{"aria-label":"add",onClick:function(){var e=a.addAccount();e&&a.setActiveAccount(e)},children:Object(S.jsx)(Ee.a,{style:{color:"white"},children:"add_circle_outline"})})}),Object(S.jsxs)(Be.a,{variant:"outlined",className:r.formControl,size:"small",children:[Object(S.jsx)(Fe.a,{id:"select-address-label"}),Object(S.jsx)(We.a,{labelId:"select-address-label",id:"select-address-label",value:null===i||void 0===i||null===(t=i.active)||void 0===t?void 0:t.address,onChange:function(e){console.log(e.target.value);var t=a.getAccountByAddress(e.target.value);t&&a.setActiveAccount(t)},children:null===i||void 0===i||null===(n=i.accounts)||void 0===n?void 0:n.map((function(e){return Object(S.jsx)(Re.a,{value:e.address,children:(t=e.address,T.a.truncateStringInTheMiddle(t,10,5))},e.address);var t}))})]})]})},Qe=n(155),He=n(152),Me=n(121),Ue=Object(f.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),textAlign:"center"},codeContainer:{width:"100%",textAlign:"center",marginBottom:"10px"},warning:{color:"#611a15",backgroundColor:"#fdecea",padding:"15px",textAlign:"center"}}})),Le=function(){var e,t=Ue(),n=i.a.useState(!1),r=Object(_.a)(n,2),c=r[0],o=r[1],u=i.a.useState(""),l=Object(_.a)(u,2),d=l[0],h=l[1],f=X(),v=Object(s.b)().enqueueSnackbar,b=f.walletManager,p=f.provider;Object(a.useEffect)((function(){c&&(W.a.DefaultMnemonic&&h(W.a.DefaultMnemonic),console.log("login modal opened"))}),[c]);return Object(S.jsxs)("div",{children:[Object(S.jsx)(oe.a,{color:"inherit",onClick:function(){o(!0)},children:"Login"}),Object(S.jsx)(Qe.a,{className:t.modal,open:c,onClose:function(){o(!1)},closeAfterTransition:!0,BackdropComponent:He.a,BackdropProps:{timeout:500},children:Object(S.jsx)(Me.a,{in:c,children:Object(S.jsxs)("div",{className:t.paper,children:[Object(S.jsxs)("div",{className:t.codeContainer,children:[Object(S.jsx)(g.a,{children:"Scan the QR code via Vite Wallet App"}),Object(S.jsx)(Ve,{text:null===(e=p.vite.connector)||void 0===e?void 0:e.uri})]}),Object(S.jsx)(oe.a,{variant:"contained",onClick:function(){b.createWebWallet(d)||v("Invalid mnemonic")},children:"Use test account"})]})})})]})},Pe=n(83),ze=Object(f.a)((function(e){return{qrcode:{background:"#fff",padding:"10px"}}})),Ve=function(e){var t=ze(),n=Object(a.useRef)(null);return console.log(e.text),Object(a.useEffect)((function(){var t={size:240,ecLevel:Pe.ecLevel.HIGH,minVersion:4,background:"#fff",mode:Pe.modes.DRAW_WITH_IMAGE_BOX,radius:0,image:"./icon.png",mSize:.3};e.text&&n.current&&(n.current.innerHTML="",new Pe.qrcode(n.current).generate(e.text,t).then((function(){console.log("QR code generated")})))}),[e.text]),Object(S.jsx)(S.Fragment,{children:Object(S.jsx)("div",{className:t.qrcode,ref:n})})},Ke=n(214),Ze=n(215),Ge=(Object(f.a)({root:{minWidth:275,minHeight:170},title:{fontSize:14},unit:{marginLeft:5}}),Object(f.a)({root:{minWidth:275,minHeight:211,textAlign:"center"},title:{fontSize:14,marginBottom:10},blockHeight:{marginTop:15},chip:{marginTop:15}})),Je=function(){var e=Ge(),t=X(),n=function(e){var t=Object(a.useState)(W.a.InitialNetworkBlockHeight),n=Object(_.a)(t,2),r=n[0],i=n[1],c=new ee.a,o=function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.provider.vite.getSnapshotChainHeightAsync();case 3:n=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),n=W.a.InitialNetworkBlockHeight;case 9:i(n),e.provider.networkStore.blockHeight=n,c.next(n);case 12:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){o()}),[e]),{blockHeight:r,blockHeightSubject:c,fetchBlockHeight:o}}(t),r=n.blockHeight,i=n.fetchBlockHeight;Object(a.useEffect)((function(){var e=setInterval(Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:case"end":return e.stop()}}),e)}))),1e3);return function(){clearInterval(e)}}));var c=t.provider.networkStore.network;return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(Ke.a,{className:e.root,children:Object(S.jsxs)(Ze.a,{children:[Object(S.jsx)(g.a,{className:e.title,color:"textSecondary",children:"Network"}),Object(S.jsx)(w.a,{size:"small",label:null===c||void 0===c?void 0:c.name})," / ",Object(S.jsx)(w.a,{size:"small",label:null===c||void 0===c?void 0:c.networkId}),Object(S.jsx)(g.a,{className:e.blockHeight,variant:"h5",component:"h2",children:r}),Object(S.jsx)(g.a,{color:"textSecondary",children:"Block height"}),Object(S.jsx)(w.a,{className:e.chip,size:"small",label:null===c||void 0===c?void 0:c.rpcUrl})]})})})},Xe=Object(f.a)((function(e){return Object(Ne.a)({formControl:{margin:e.spacing(1),"& .MuiSelect-root":{color:e.palette.common.white},"& .MuiSvgIcon-root":{color:e.palette.common.white}},selectEmpty:{marginTop:e.spacing(2)}})})),Ye=function(e){var t=Xe(),n=e.networkStore.networks,r=Object(a.useState)(e.networkStore.network),i=Object(_.a)(r,2),c=i[0],o=i[1];return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(Be.a,{variant:"outlined",className:t.formControl,size:"small",children:[Object(S.jsx)(Fe.a,{id:"select-network-label"}),Object(S.jsx)(We.a,{labelId:"select-network-label",id:"select-network-label",value:null===c||void 0===c?void 0:c.id,onChange:function(t){console.log(t.target.value);var r=n.find((function(e){return e.id===t.target.value}));r&&(e.networkStore.network=r,o(r)),window.location.reload()},children:n.map((function(e){return Object(S.jsx)(Re.a,{value:e.id,children:e.name},e.id)}))})]})})},$e=_e.a.div(me||(me=Object(ye.a)(["\n  flex-grow: 1;\n"]))),et=Object(_e.a)(g.a)(xe||(xe=Object(ye.a)(["\n  flex-grow: 1;\n  margin-left: 10px !important;\n"]))),tt=function(e){var t=new K;return Object(S.jsx)($e,{children:Object(S.jsx)(Ce.a,{position:"static",children:Object(S.jsxs)(qe.a,{children:[Object(S.jsx)("img",{src:"./icon_white.png",alt:"logo",width:"30"}),Object(S.jsx)(et,{variant:"h6",children:"Vite Quota Bank"}),Object(S.jsx)(Ye,{networkStore:t})]})})})},nt=function(e){var t=X(),n=new K,r=t.walletManager,a=t.provider,i=r.getWallet(),c=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=a.vite.connector)||void 0===t?void 0:t.killSessionAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:r.removeWallet(),n.clear(),window.location.reload();case 11:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(S.jsx)($e,{children:Object(S.jsx)(Ce.a,{position:"static",children:Object(S.jsxs)(qe.a,{children:[Object(S.jsx)("img",{src:"./icon_white.png",alt:"logo",width:"30"}),Object(S.jsx)(et,{variant:"h6",children:"Vite Quota Bank"}),Object(S.jsx)(Ye,{networkStore:n}),(null===i||void 0===i?void 0:i.active)&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Te,{}),Object(S.jsx)(oe.a,{color:"inherit",onClick:Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:case"end":return e.stop()}}),e)}))),children:"Logout"})]}),!(null===i||void 0===i?void 0:i.active)&&Object(S.jsx)(Le,{})]})})})},rt=n(82),at=n(219),it=_e.a.div(Oe||(Oe=Object(ye.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  align-items: center;\n  padding-bottom: 15px;\n  padding-top: 30px;\n  overflow: auto;\n  overflow-x: hidden;\n"]))),ct=_e.a.div(ge||(ge=Object(ye.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]))),ot=function(e){var t=e.children,n=Object(rt.a)(e,["children"]);return Object(S.jsx)(it,Object(y.a)(Object(y.a)({},n),{},{children:Object(S.jsx)(at.a,{maxWidth:"lg",children:Object(S.jsx)(ct,{children:t})})}))},st=_e.a.div(ke||(ke=Object(ye.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n"]))),ut=function(e){var t=e.children,n=Object(rt.a)(e,["children"]);return Object(S.jsx)(st,Object(y.a)(Object(y.a)({},n),{},{children:t}))},lt=function(e){var t,n=null!==(t=e.defaultValue)&&void 0!==t?t:"-";return Object(S.jsx)(S.Fragment,{children:function(){var t;if(e.value&&e.value.length>e.maxLength){var r=T.a.truncateString(e.value,e.maxLength);return Object(S.jsx)(k.a,{title:e.value,placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)("span",{children:null!==r&&void 0!==r?r:n})})}return Object(S.jsx)("span",{children:null!==(t=e.value)&&void 0!==t?t:n})}()})},dt=n(80),ht=n.n(dt),ft=Object(f.a)((function(e){return{root:{width:"100%"},title:{fontWeight:500,marginBottom:20},refreshButton:{float:"right"}}})),vt=function(){var e,t,n=ft(),i=X(),c=i.account,o=i.provider.emitter,s=Object(a.useState)(new I.e),u=Object(_.a)(s,2),h=u[0],f=u[1],k=Object(a.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(new I.e),!i.account){e.next=12;break}return e.prev=2,e.next=5,i.provider.bank.getRequestByAddress(i.account);case 5:t=e.sent,f(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),f(new I.e);case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),[i,f]);return Object(a.useEffect)((function(){var e=function(e){c===e.address&&(console.log("Handle QuotaRequestUpdated",e.address),f(e))},t=function(e){c===e&&(console.log("Handle QuotaRequestDeleted",e),f(new I.e))};return o.on(r.QuotaRequestUpdated,e),o.on(r.QuotaRequestDeleted,t),k(),function(){console.log("AccountQuotaRequestTable disposed"),o.off(r.QuotaRequestUpdated,e),o.off(r.QuotaRequestDeleted,t)}}),[c,o,k,f]),Object(a.useEffect)((function(){var e=function(e){var t=new I.e(h);t.update(e),h.equals(t)||(console.log("AccountQuotaRequestTable changed",h.address,e),f(t))};return o.on(r.NetworkBlockHeight,e),function(){o.off(r.NetworkBlockHeight,e)}}),[o,h,f]),Object(S.jsxs)("div",{className:n.root,children:[Object(S.jsxs)(g.a,{className:n.title,children:["My Quota Request",Object(S.jsx)(De.a,{className:n.refreshButton,"aria-label":"refresh",onClick:k,children:Object(S.jsx)(ht.a,{fontSize:"small"})})]}),Object(S.jsx)(v.a,{children:Object(S.jsx)(b.a,{children:Object(S.jsxs)(p.a,{children:[Object(S.jsx)(j.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:"Note"}),Object(S.jsx)(x.a,{children:"Amount"}),Object(S.jsx)(x.a,{children:"Expected Snapshot Height"}),Object(S.jsx)(x.a,{children:"Expected Due Date"}),Object(S.jsx)(x.a,{children:"Status"})]})}),Object(S.jsx)(O.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:Object(S.jsx)(lt,{value:h.note,maxLength:24})}),Object(S.jsx)(x.a,{children:null!==(e=null===h||void 0===h?void 0:h.amountFormatted)&&void 0!==e?e:"-"}),Object(S.jsx)(x.a,{children:null!==(t=null===h||void 0===h?void 0:h.expirationHeight)&&void 0!==t?t:"-"}),Object(S.jsx)(x.a,{children:Object(S.jsx)(xt,{quotaRequest:h})}),Object(S.jsx)(x.a,{children:(null===h||void 0===h?void 0:h.status)?Object(S.jsx)(w.a,{size:"small",label:h.status}):"-"})]})})]})})})]})},bt=n(229),pt=n(29),jt=Object(f.a)((function(e){return{root:{display:"flex",width:"100%"},noteInput:{flexGrow:1,marginRight:20}}})),mt=function(){var e=jt(),t=i.a.useState(!1),n=Object(_.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),u=Object(_.a)(o,2),h=u[0],f=u[1],v=X().provider,b=Object(s.b)().enqueueSnackbar,p=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.bank.createRequest(h);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),b(pt.a.formatSnackbarMessage(e.t0));case 8:c(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),j=function(){c(!1)};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("form",{className:e.root,noValidate:!0,autoComplete:"off",children:[Object(S.jsx)(bt.a,{className:e.noteInput,size:"small",label:"Request note",variant:"outlined",value:h,onChange:function(e){return f(e.target.value)}}),Object(S.jsx)(oe.a,{variant:"contained",color:"primary",onClick:function(){c(!0)},children:"Request Quota"})]}),Object(S.jsxs)(ue.a,{open:r,onClose:j,children:[Object(S.jsx)(fe.a,{children:"Confirm quota request"}),Object(S.jsx)(de.a,{children:Object(S.jsx)(he.a,{children:"You will receive quota as soon as the Vite Quota Bank accepts the request. Please note that this is a manual operation, hence some delays could be associated."})}),Object(S.jsxs)(le.a,{children:[Object(S.jsx)(oe.a,{color:"primary",onClick:j,children:"Cancel"}),Object(S.jsx)(se,{color:"primary",callbackFn:p,children:"Confirm"})]})]})]})},xt=function(e){return Object(S.jsx)(S.Fragment,{children:function(){var t,n,r,a,i,c,o,s;return(null===e||void 0===e||null===(t=e.quotaRequest)||void 0===t?void 0:t.isExpired)?(null===e||void 0===e||null===(n=e.quotaRequest)||void 0===n?void 0:n.amount)?Object(S.jsx)(k.a,{title:null!==(r=null===e||void 0===e||null===(a=e.quotaRequest)||void 0===a?void 0:a.expirationDateFormatted)&&void 0!==r?r:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)("span",{children:"Staking expired!"})}):Object(S.jsx)(k.a,{title:null!==(i=null===e||void 0===e||null===(c=e.quotaRequest)||void 0===c?void 0:c.expirationDateFormatted)&&void 0!==i?i:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)("span",{children:"Request has expired!"})}):Object(S.jsx)("span",{children:null!==(o=null===e||void 0===e||null===(s=e.quotaRequest)||void 0===s?void 0:s.expirationDateFormatted)&&void 0!==o?o:"-"})}()})},Ot=n(116),gt=n.n(Ot),kt=n(212),wt=n(153),yt=n(220),_t=function(e){var t=Object(s.b)().enqueueSnackbar,n=function(){var n=Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.item.address){n.next=7;break}return n.next=4,e.bank.deleteRequest(e.item.address);case 4:e.closeFn(),n.next=8;break;case 7:throw new Error("No address provided.");case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),t(pt.a.formatSnackbarMessage(n.t0));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(ue.a,{open:e.open,onClose:e.closeFn,children:[Object(S.jsx)(fe.a,{children:"Confirm deletion"}),Object(S.jsx)(de.a,{children:Object(S.jsxs)(kt.a,{children:[Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Address",secondary:e.item.address})}),Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Note",secondary:e.item.note})})]})}),Object(S.jsxs)(le.a,{children:[Object(S.jsx)(oe.a,{color:"primary",onClick:e.closeFn,children:"Cancel"}),Object(S.jsx)(se,{color:"secondary",callbackFn:n,autoFocus:!0,children:"Delete"})]})]})})},St=Object(f.a)((function(e){return{form:{width:"100%"},durationInput:{float:"right"}}})),At=function(e){var t=St(),n=Object(s.b)().enqueueSnackbar,r=Object(a.useState)(""),i=Object(_.a)(r,2),c=i[0],o=i[1],u=Object(a.useState)(""),h=Object(_.a)(u,2),f=h[0],v=h[1],b=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.item.address){t.next=7;break}return t.next=4,e.bank.stakeRequest(e.item.address,Number.parseInt(c),Number.parseInt(f));case 4:e.closeFn(),t.next=8;break;case 7:throw new Error("No address provided.");case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),n(pt.a.formatSnackbarMessage(t.t0));case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(ue.a,{open:e.open,onClose:e.closeFn,children:[Object(S.jsx)(fe.a,{children:"Confirm quota staking"}),Object(S.jsxs)(de.a,{children:[Object(S.jsxs)(kt.a,{children:[Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Address",secondary:e.item.address})}),Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Note",secondary:e.item.note})})]}),Object(S.jsxs)("form",{className:t.form,autoComplete:"off",children:[Object(S.jsx)(bt.a,{autoFocus:!0,margin:"dense",label:"Amount",type:"number",value:c,inputProps:{min:1},onChange:function(e){return o(e.target.value)}}),Object(S.jsx)(bt.a,{margin:"dense",label:"Duration (blocks)",type:"number",className:t.durationInput,value:f,inputProps:{min:1},onChange:function(e){return v(e.target.value)}})]})]}),Object(S.jsxs)(le.a,{children:[Object(S.jsx)(oe.a,{color:"primary",onClick:e.closeFn,children:"Cancel"}),Object(S.jsx)(se,{color:"primary",callbackFn:b,autoFocus:!0,children:"Confirm"})]})]})})},Ct=function(e){var t=Object(s.b)().enqueueSnackbar,n=function(){var n=Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.item.address){n.next=7;break}return n.next=4,e.bank.withdrawRequest(e.item.address);case 4:e.closeFn(),n.next=8;break;case 7:throw new Error("No address provided.");case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),t(pt.a.formatSnackbarMessage(n.t0));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(ue.a,{open:e.open,onClose:e.closeFn,children:[Object(S.jsx)(fe.a,{children:"Confirm withdraw"}),Object(S.jsx)(de.a,{children:Object(S.jsxs)(kt.a,{children:[Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Address",secondary:e.item.address})}),Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Note",secondary:e.item.note})}),Object(S.jsx)(wt.a,{children:Object(S.jsx)(yt.a,{primary:"Amount",secondary:e.item.amountFormatted})})]})}),Object(S.jsxs)(le.a,{children:[Object(S.jsx)(oe.a,{color:"primary",onClick:e.closeFn,children:"Cancel"}),Object(S.jsx)(se,{color:"primary",callbackFn:n,autoFocus:!0,children:"Confirm"})]})]})})};!function(e){e.Stake="STAKE",e.Withdraw="WITHDRAW",e.Delete="DELETE"}(we||(we={}));var qt=Object(f.a)((function(e){return{refreshButton:{float:"right"},stakeButton:{marginRight:20}}})),Rt=function(e){var t,n,i,c=qt(),o=e.context.provider.emitter,s=Object(a.useState)(e.item),u=Object(_.a)(s,2),l=u[0],d=u[1];Object(a.useEffect)((function(){var e=function(e){var t=new I.e(l);t.update(e),l.equals(t)||(console.log("BankQuotaRequest changed",l.address,e),d(t))},t=function(e){l.address===e.address&&(console.log("Handle QuotaRequestUpdated",e.address),d(e))};return o.on(r.NetworkBlockHeight,e),o.on(r.QuotaRequestUpdated,t),function(){o.off(r.NetworkBlockHeight,e),o.off(r.QuotaRequestUpdated,t)}}),[o,l,d]);var h,f;return Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:Object(S.jsx)(k.a,{title:null!==(t=l.address)&&void 0!==t?t:"",placement:"top",arrow:!0,interactive:!0,children:Object(S.jsx)(w.a,{size:"small",label:(f=l.address,T.a.truncateStringInTheMiddle(f,10,5))})})}),Object(S.jsx)(x.a,{children:Object(S.jsx)(lt,{value:l.note,maxLength:24})}),Object(S.jsx)(x.a,{children:null!==(n=l.amountFormatted)&&void 0!==n?n:"-"}),Object(S.jsx)(x.a,{children:null!==(i=l.expirationHeight)&&void 0!==i?i:"-"}),Object(S.jsx)(x.a,{children:Object(S.jsx)(xt,{quotaRequest:l})}),Object(S.jsx)(x.a,{align:"right",children:e.context.provider.networkStore.blockHeight!==W.a.InitialNetworkBlockHeight&&Object(S.jsxs)("div",{children:[(h=l,T.a.isNullOrDefault(h.amount,W.a.DefaultZeroString)&&Object(S.jsx)(oe.a,{size:"small",variant:"contained",color:"primary",className:c.stakeButton,onClick:function(){e.handleClickOpenFn(we.Stake,l)},children:"Stake"})),function(e){return e.amount&&e.amount!==W.a.DefaultZeroString&&!e.isExpired}(l)&&Object(S.jsx)(w.a,{size:"small",label:"Staked"}),function(e){return e.amount&&e.amount!==W.a.DefaultZeroString&&e.isExpired}(l)&&Object(S.jsx)(oe.a,{size:"small",variant:"outlined",onClick:function(){e.handleClickOpenFn(we.Withdraw,l)},children:"Withdraw"}),function(e){return T.a.isNullOrDefault(e.amount,W.a.DefaultZeroString)}(l)&&Object(S.jsx)(De.a,{"aria-label":"delete",onClick:function(){e.handleClickOpenFn(we.Delete,l)},children:Object(S.jsx)(gt.a,{fontSize:"small"})})]})})]})},Nt=n(92),Dt=Object(f.a)((function(e){return{root:{width:"100%"},title:{fontWeight:500,marginBottom:20},refreshButton:{float:"right"},stakeButton:{marginRight:20}}})),Et=function(){var e=Dt(),t=X(),n=t.provider.emitter,c=function(e){var t=[],n=Object(a.useState)(!1),r=Object(_.a)(n,2),i=r[0],c=r[1],o=Object(a.useState)(t),s=Object(_.a)(o,2),u=s[0],h=s[1],f=function(){var n=Object(d.a)(l.a.mark((function n(){var r,a,i,o,s,u=arguments;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u.length>0&&void 0!==u[0]&&u[0],c(!0),console.log("fetchQuotaRequests"),h([]),n.prev=4,n.next=7,e.provider.bank.getRequests();case 7:r=n.sent,a=[],i=0;case 10:if(!(i<r.length)){n.next=25;break}return o=r[i],n.prev=12,n.next=15,e.provider.bank.getRequestByAddress(o);case 15:s=n.sent,a.unshift(s),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(12),console.log(n.t0);case 22:i++,n.next=10;break;case 25:h(a),n.next=32;break;case 28:n.prev=28,n.t1=n.catch(4),console.log(n.t1),h(t);case 32:c(!1);case 33:case"end":return n.stop()}}),n,null,[[4,28],[12,19]])})));return function(){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log("useQuotaRequests"),f(!0)}),[e]),{isLoading:i,quotaRequests:u,fetchQuotaRequests:f,setQuotaRequests:h}}(t),o=c.isLoading,s=c.quotaRequests,u=c.fetchQuotaRequests,h=c.setQuotaRequests,f=i.a.useState(new I.e),k=Object(_.a)(f,2),w=k[0],y=k[1],A=i.a.useState(!1),C=Object(_.a)(A,2),q=C[0],R=C[1],N=i.a.useState(!1),D=Object(_.a)(N,2),E=D[0],B=D[1],F=i.a.useState(!1),W=Object(_.a)(F,2),T=W[0],Q=W[1];console.log("render BankQuotaRequestTable",t.provider.networkStore.blockHeight),Object(a.useEffect)((function(){var e=function(e){console.log("Handle QuotaRequestUpdated",e.address);var t=s.findIndex((function(t){return t.address===e.address}));if(t>=0){var n=Object(Nt.a)(s);n[t]=e,h(n)}else{var r=[e].concat(Object(Nt.a)(s));h(r)}},t=function(e){console.log("Handle QuotaRequestDeleted",e);var t=s.filter((function(t){return t.address!==e}));t.length<s.length&&h(t)};return n.on(r.QuotaRequestUpdated,e),n.on(r.QuotaRequestDeleted,t),function(){console.log("AccountQuotaRequestTable disposed"),n.off(r.QuotaRequestUpdated,e),n.off(r.QuotaRequestDeleted,t)}}),[n,s,h]);var H=function(e,t){switch(y(t),e){case we.Stake:R(!0);break;case we.Withdraw:B(!0);break;case we.Delete:Q(!0)}},M=function(){R(!1),B(!1),Q(!1)};return Object(S.jsxs)("div",{className:e.root,children:[Object(S.jsxs)(g.a,{className:e.title,children:["Bank Quota Requests",Object(S.jsx)(De.a,{className:e.refreshButton,"aria-label":"refresh",onClick:function(){u(!0)},children:Object(S.jsx)(ht.a,{fontSize:"small"})})]}),o?Object(S.jsx)(g.a,{variant:"caption",children:"Loading..."}):Object(S.jsx)(v.a,{children:Object(S.jsx)(b.a,{children:Object(S.jsxs)(p.a,{children:[Object(S.jsx)(j.a,{children:Object(S.jsxs)(m.a,{children:[Object(S.jsx)(x.a,{children:"Address"}),Object(S.jsx)(x.a,{children:"Note"}),Object(S.jsx)(x.a,{children:"Amount"}),Object(S.jsx)(x.a,{children:"Expected Snapshot Height"}),Object(S.jsx)(x.a,{children:"Expected Due Date"}),Object(S.jsx)(x.a,{align:"center",children:"Action"})]})}),Object(S.jsx)(O.a,{children:s&&s.length>0&&s.map((function(e){return Object(S.jsx)(Rt,{context:t,item:e,handleClickOpenFn:H},e.address)}))})]})})}),Object(S.jsx)(_t,{item:w,bank:t.provider.bank,open:T,closeFn:M}),Object(S.jsx)(At,{item:w,bank:t.provider.bank,open:q,closeFn:M}),Object(S.jsx)(Ct,{item:w,bank:t.provider.bank,open:E,closeFn:M})]})},Bt=function(e){var t=X();return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.provider.bank.getOwnerAsync();case 2:n=e.sent,console.log("Bank owner:",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(ut,{children:[Object(S.jsx)(nt,{}),Object(S.jsxs)(ot,{children:[Object(S.jsxs)(h.a,{container:!0,spacing:3,children:[Object(S.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(S.jsx)(ce,{title:"My Account",address:t.account})}),Object(S.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(S.jsx)(Je,{})}),Object(S.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(S.jsx)(ce,{title:"Bank",address:W.a.BankContractAddress})}),Object(S.jsx)(h.a,{item:!0,xs:12,children:Object(S.jsx)(mt,{})}),Object(S.jsx)(h.a,{item:!0,xs:12,children:Object(S.jsx)(vt,{})}),Object(S.jsx)(h.a,{item:!0,xs:12,children:Object(S.jsx)(Et,{})})]}),Object(S.jsx)(pe,{})]}),Object(S.jsx)(Ae,{})]})})},Ft=function(){return Object(S.jsx)(s.a,{maxSnack:3,children:Object(S.jsx)(ae,{children:Object(S.jsx)(Y,{children:Object(S.jsx)(Bt,{})})})})},Wt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,230)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))},It=n(221),Tt=n(117),Qt=Object(Tt.a)();o.a.render(Object(S.jsx)(It.a,{theme:Qt,children:Object(S.jsx)(Ft,{})}),document.getElementById("root")),Wt()},16:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return h}));var r=n(10),a=n(11),i=n(13),c=n(42),o=n(23),s=n(61),u=n.n(s),l=function(){function e(){Object(r.a)(this,e),u.a.locale(navigator.language)}return Object(a.a)(e,[{key:"setLocale",value:function(e){u.a.locale(e)}},{key:"get",value:function(){return u()()}},{key:"getFromUnix",value:function(e){return u.a.unix(e)}},{key:"getLocal",value:function(e){return u.a.utc(e).local()}},{key:"getLocalTime",value:function(e){return this.getLocal(e).format("LTS")}},{key:"getLocalDate",value:function(e){return this.getLocal(e).format("L")}},{key:"getLocalFormatted",value:function(e){return this.getLocalTime(e)+" "+this.getLocalDate(e)}},{key:"getLocalReverseFormatted",value:function(e){return this.getLocalDate(e)+" "+this.getLocalTime(e)}}]),e}(),d=function(){function e(){Object(r.a)(this,e),this.moment=void 0,this.moment=new l}return Object(a.a)(e,[{key:"update",value:function(e,t){if(null===e||void 0===e?void 0:e.expirationHeight){if(e.isExpired=o.a.isExpired(e.expirationHeight,t),!e.expirationDate&&t&&t!==i.a.InitialNetworkBlockHeight){var n=Number.parseInt(c.a.minus(e.expirationHeight,t));e.expirationDate=this.moment.get().add(n,"s").toDate(),e.expirationDateFormatted=this.moment.getLocalReverseFormatted(e.expirationDate)}e.status="Unknown",e.isExpired?e.status="Expired":e.amount?e.status="Active":e.status="Pending"}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();d.instance=void 0;var h,f=n(29),v=function(){function e(t){Object(r.a)(this,e),this.address=void 0,this.contractName=void 0,this.binary=void 0,this.offChain=void 0,this.abi=void 0,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){e&&(this.contractName=e.contractName,this.binary=e.binary,this.offChain=e.offChain,this.abi=e.abi)}}]),e}(),b=function(){function e(t){Object(r.a)(this,e),this.amount=i.a.DefaultZeroString,this.amountFormatted=i.a.DefaultZeroString,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){if(null===e||void 0===e?void 0:e.balanceInfoMap){var t=e.balanceInfoMap[i.a.ViteTokenId];this.amount=t.balance,this.amountFormatted=f.a.formatAmount(t.balance)}}}]),e}(),p=function(){function e(t){Object(r.a)(this,e),this.id=void 0,this.networkId=void 0,this.name=void 0,this.rpcUrl=void 0,this.connectorUrl=void 0,this.mock=!1,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){var t;e&&(this.id=e.id,this.networkId=e.networkId,this.name=e.name,this.rpcUrl=e.rpcUrl,this.connectorUrl=e.connectorUrl,this.mock=null!==(t=e.mock)&&void 0!==t&&t)}}]),e}(),j=function(){function e(t){Object(r.a)(this,e),this.currentQuota=i.a.DefaultZeroString,this.currentQuotaFormatted=i.a.DefaultZeroString,this.maxQuota=i.a.DefaultZeroString,this.maxQuotaFormatted=i.a.DefaultZeroString,this.stakeAmount=i.a.DefaultZeroString,this.stakeAmountFormatted=i.a.DefaultZeroString,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){e&&(this.currentQuota=e.currentQuota,this.currentQuotaFormatted=f.a.formatQuota(e.currentQuota),this.maxQuota=e.maxQuota,this.maxQuotaFormatted=f.a.formatQuota(e.maxQuota),this.stakeAmount=e.stakeAmount,this.stakeAmountFormatted=f.a.formatAmount(e.stakeAmount))}}]),e}(),m=function(){function e(t){Object(r.a)(this,e),this.address=void 0,this.note=void 0,this.amount=void 0,this.amountFormatted=void 0,this.expirationHeight=void 0,this.expirationDate=void 0,this.expirationDateFormatted=void 0,this.isExpired=!1,this.status=void 0,this.init(t)}return Object(a.a)(e,[{key:"init",value:function(e){e&&(this.address=e.address,this.note=e.note,this.amount=e.amount,this.amountFormatted=f.a.formatAmount(e.amount),this.expirationHeight=e.expirationHeight,this.expirationDate=e.expirationDate,this.expirationDateFormatted=e.expirationDateFormatted,this.isExpired=e.isExpired,this.status=e.status)}},{key:"update",value:function(t){e.updater.update(this,t)}},{key:"equals",value:function(e){return this.address===e.address&&this.note===e.note&&this.amount===e.amount&&this.amountFormatted===e.amountFormatted&&this.expirationHeight===e.expirationHeight&&this.expirationDateFormatted===e.expirationDateFormatted&&this.isExpired===e.isExpired&&this.status===e.status}}]),e}();m.updater=d.getInstance(),function(e){e.RequestCreated="RequestCreated",e.RequestDeleted="RequestDeleted"}(h||(h={}))},23:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(10),a=n(11),i=n(42),c=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"isString",value:function(e){return"string"===typeof e||e instanceof String}},{key:"isNullOrWhitespace",value:function(t){return!e.isString(t)||(null===t||void 0===t||""===t.trim())}},{key:"isNullOrDefault",value:function(t,n){return e.isNullOrWhitespace(t)||t===n}},{key:"isExpired",value:function(e,t){return!(!e||!t)&&1===i.a.compared(t,e)}},{key:"timeout",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}();c.truncateString=function(e,t){return e&&t<e.length?"".concat(e.substr(0,t),"..."):e},c.truncateStringInTheMiddle=function(e,t,n){if(e&&t+n<e.length)return"".concat(e.substr(0,t),"...").concat(e.substr(e.length-n,e.length));return e}},29:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10),a=n(11),i=n(13),c=n(42),o=n(23),s=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"formatQuota",value:function(e){try{var t=c.a.toBasic(Number.parseInt(e)/i.a.QuotaPerUT,0,3);return o.a.isNullOrWhitespace(t)?void 0:t}catch(n){return"-1"}}},{key:"formatAmount",value:function(e){try{var t=c.a.toBasic(Number.parseInt(e),i.a.DefaultDecimals);return o.a.isNullOrWhitespace(t)?void 0:t}catch(n){return"-1"}}},{key:"formatSnackbarMessage",value:function(e){if(e){var t,n;if(console.log(e),o.a.isString(e))t=e;else t=e.message?e.message:(null===(n=e.error)||void 0===n?void 0:n.message)?e.error.message:JSON.stringify(e);return t.length>128?t.substr(0,128)+"...":t}return"Something went wrong."}}]),e}()},42:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(10),a=n(11),i=n(20),c=n.n(i),o={decimalSeparator:".",groupSeparator:"",groupSize:0,secondaryGroupSize:0,fractionGroupSeparator:"",fractionGroupSize:0},s={FORMAT:o,ROUNDING_MODE:c.a.ROUND_DOWN},u={FORMAT:{decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0},ROUNDING_MODE:c.a.ROUND_DOWN},l={FORMAT:o,ROUNDING_MODE:c.a.ROUND_CEIL};c.a.config(s);var d=c.a.clone(u),h=c.a.clone(l),f=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"compared",value:function(e,t){return e=new c.a(e),t=new c.a(t),e.comparedTo(t)}},{key:"isEqual",value:function(e,t){return e=new c.a(e),t=new c.a(t),e.isEqualTo(t)}},{key:"minus",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fix";e=new c.a(e),t=new c.a(t);var a=e.minus(t);return"fix"===r?a.toFormat(n):a.decimalPlaces(n,1).toFormat()}},{key:"plus",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fix";e=new c.a(e),t=new c.a(t);var a=e.plus(t);return"fix"===r?a.toFormat(n):a.decimalPlaces(n,1).toFormat()}},{key:"multi",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;return e=new c.a(e),t=new c.a(t),e.multipliedBy(t).toFormat(n)}},{key:"dividedToNumber",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fix";if(e=new c.a(e),t=new c.a(t),0===n)return e.dividedBy(t).integerValue().toString();var a=e.dividedBy(t);return"fix"===r?a.toFormat(n):a.decimalPlaces(n,1).toFormat()}},{key:"dividedCeil",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=new h(e),t=new h(t);var r=e.dividedBy(t);return r.toFormat(n)}},{key:"toBasic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=new c.a(10).exponentiatedBy(t);if(null===(e=new c.a(e)).c)return"";try{return e.dividedBy(r).decimalPlaces(n,1).toFormat()}catch(a){return""}}},{key:"exponentiated",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new c.a(e).exponentiatedBy(t),a=new c.a(n),i=r.plus(a);return i.toFormat()}},{key:"toMin",value:function(e,t){var n=new c.a(10).exponentiatedBy(t);if(null===(e=new c.a(e)).c)return"";try{return e.multipliedBy(n).toFormat()}catch(r){return""}}},{key:"formatNum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;t=t>=n?n:t;var r=new d(e);return r.toFormat(t)}},{key:"normalFormatNum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;t=t>=n?n:t;var r=new c.a(e);return r.toFormat(t)}},{key:"onlyFormat",value:function(e,t){var n=new d(e).toFormat();if("undefined"===typeof t)return n;var r=n.split(".")[1]||"";if(r.length>=t)return n;r.length||(n+=".");for(var a=0;a<t-r.length;a++)n+="0";return n}}]),e}()},43:function(e,t,n){"use strict";n.d(t,"e",(function(){return k})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return C})),n.d(t,"c",(function(){return p})),n.d(t,"h",(function(){return j})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"i",(function(){return O})),n.d(t,"b",(function(){return g}));var r,a=n(4),i=n.n(a),c=n(7),o=n(10),s=n(11),u=n(62),l=n(37),d=n(32),h=n(31),f=n(111),v=n.n(f);!function(e){e.Web="Web",e.Session="Session"}(r||(r={}));var b,p=function(){function e(t,n){Object(o.a)(this,e),this._type=void 0,this.active=void 0,this.accounts=[],this._type=t,this.baseInitinit(n)}return Object(s.a)(e,[{key:"type",get:function(){return this._type}},{key:"baseInitinit",value:function(e){var t=this;e&&(this.active=e.active?this.createAccount(e.active):void 0,e.accounts&&Array.isArray(e.accounts)&&e.accounts.forEach((function(e){t.accounts.push(t.createAccount(e))}))),this.accounts||(this.accounts=[])}}],[{key:"fromJS",value:function(e){switch((e="object"===typeof e?e:{})._type){case r.Web:return new j(e);case r.Session:return new m(e)}}}]),e}(),j=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,r.Web,e)).mnemonic=void 0,a.init(e),a}return Object(s.a)(n,[{key:"init",value:function(e){e&&(this.mnemonic=e.mnemonic)}},{key:"createAccount",value:function(e){return new O(e)}}]),n}(p),m=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,r.Session,e)).session=void 0,a.timestamp=void 0,a.init(e),a}return Object(s.a)(n,[{key:"init",value:function(e){e&&(this.session=e.session,this.timestamp=e.timestamp)}},{key:"createAccount",value:function(e){return new g(e)}}]),n}(p);!function(e){e.Web="Web",e.Session="Session"}(b||(b={}));var x=function(){function e(t,n){Object(o.a)(this,e),this._type=void 0,this.id=void 0,this.address=void 0,this._type=t,this.baseInit(n)}return Object(s.a)(e,[{key:"type",get:function(){return this._type}},{key:"baseInit",value:function(e){e&&(this.id=e.id,this.address=e.address)}}],[{key:"fromJS",value:function(e){switch((e="object"===typeof e?e:{})._type){case r.Web:return new O(e);case r.Session:return new g(e)}}}]),e}(),O=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,b.Web,e)).privateKey=void 0,r.init(e),r}return Object(s.a)(n,[{key:"init",value:function(e){e&&(this.privateKey=e.privateKey)}}]),n}(x),g=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,b.Session,e)}return n}(x),k=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(o.a)(this,n),(i=t.call(this,r,a))._walletManager=void 0,i._walletManager=e,i.on("connect",(function(e,t){console.log("WalletConnector.connect",e,t);var n=t.params[0].accounts;i.saveSession(n)})),i.on("disconnect",(function(e,t){console.log("WalletConnector.disconnect",e,t),i.stopBizHeartBeat()})),i.on("session_update",(function(e,t){console.log("WalletConnector.session_update",e,t);var n=t[0];n&&n.accounts&&i.saveSession(n.accounts)})),i}return Object(s.a)(n,[{key:"uri",get:function(){return Object(u.a)(Object(l.a)(n.prototype),"uri",this)}},{key:"on",value:function(e,t){return Object(u.a)(Object(l.a)(n.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return Object(u.a)(Object(l.a)(n.prototype),"off",this).call(this,e,t)}},{key:"saveSession",value:function(e){if(!e||!e[0])throw new Error("address is null");for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(new g({id:n.toString(),address:r}))}var a=new m({active:t[0],accounts:t,session:this.session,timestamp:(new Date).getTime()});this._walletManager.setWallet(a)}},{key:"updateSession",value:function(){var e=this._walletManager.getWallet();e&&e instanceof m&&(e.timestamp=(new Date).getTime(),this._walletManager.updateWalletStore(e))}},{key:"createSession",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)(Object(l.a)(n.prototype),"createSession",this).call(this);case 2:return e.abrupt("return",this.uri);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendTransactionAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,n,r,a=this,c=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=c.length,n=new Array(t),r=0;r<t;r++)n[r]=c[r];return e.abrupt("return",new Promise((function(e,t){a.on("disconnect",(function(){t("Request aborted due to disconnect.")})),a.sendCustomRequest({method:"vite_signAndSendTx",params:n}).then((function(t){a.updateSession(),e(t)})).catch((function(e){t(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"signMessageAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,n,r,a=this,c=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=c.length,n=new Array(t),r=0;r<t;r++)n[r]=c[r];return e.abrupt("return",new Promise((function(e,t){a.on("disconnect",(function(){t("Request aborted due to disconnect.")})),a.sendCustomRequest({method:"vite_signMessage",params:n}).then((function(t){a.updateSession(),e(t)})).catch((function(e){t(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"killSessionAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)(Object(l.a)(n.prototype),"killSession",this).call(this);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(v.a),w=function(){function e(t){Object(o.a)(this,e),this._walletManager=void 0,this._walletManager=t}return Object(s.a)(e,[{key:"create",value:function(e){var t=this._walletManager.getValidSession(),n=this._walletManager.getActiveAccount(),r={bridge:e.connectorUrl,session:t},a=n?{lastAccount:n.address}:void 0,i=new k(this._walletManager,r,a);return t||i.createSession().then((function(){return console.log("IWalletConnector connected",i.uri)})),i}}]),e}(),y=n(33),_=n(77),S=n(13),A=function(){function e(){Object(o.a)(this,e),this._webWalletKey=S.a.WebWalletStorageSpace,this._sessionWalletKey=S.a.SessionWalletStorageSpace}return Object(s.a)(e,[{key:"clear",value:function(){localStorage.removeItem(this._webWalletKey),sessionStorage.removeItem(this._sessionWalletKey)}},{key:"getItem",value:function(){var e;try{(e=localStorage.getItem(this._webWalletKey))||(e=sessionStorage.getItem(this._sessionWalletKey))}catch(t){return void console.error(t)}if(e)try{return p.fromJS(JSON.parse(e))}catch(t){return void console.log(t)}}},{key:"setItem",value:function(e){var t=JSON.stringify(e);try{switch(e.type){case r.Web:localStorage.setItem(this._webWalletKey,t);break;case r.Session:sessionStorage.setItem(this._sessionWalletKey,t);break;default:throw new Error("Wallet type '".concat(e.type,"' is not supported."))}}catch(n){console.error(n)}}}]),e}(),C=function(){function e(){Object(o.a)(this,e),this._emitter=void 0,this._store=void 0,this._wallet=void 0,this._mnemonicDeriveIndex=0,this._setWalletCallback=void 0,this._emitter=new _.EventEmitter,this._store=new A,this.initWallet()}return Object(s.a)(e,[{key:"initWallet",value:function(){var e=this._store.getItem();e&&(this._wallet=e,this._mnemonicDeriveIndex=e.accounts.length)}},{key:"onSetWalletCallback",set:function(e){this._setWalletCallback=e}},{key:"getWallet",value:function(){return this._wallet}},{key:"setWallet",value:function(e){this._wallet=e,this.updateWalletStore(e),this.updateWallet()}},{key:"updateWallet",value:function(){this._setWalletCallback&&this._setWalletCallback(this._wallet)}},{key:"updateWalletStore",value:function(e){e&&this._store.setItem(e)}},{key:"createWebWallet",value:function(e){if(this.validateMnemonic(e)){this.resetWallet();var t=this.createWebWalletAccount(e,0),n=new j({active:t,mnemonic:e,accounts:[t]});return this.setWallet(n),n}}},{key:"removeWallet",value:function(){this.resetWallet(),this.updateWallet()}},{key:"getAccountByAddress",value:function(e){var t,n;return null===(t=this._wallet)||void 0===t||null===(n=t.accounts)||void 0===n?void 0:n.find((function(t){return t.address===e}))}},{key:"addAccount",value:function(){if(this._wallet instanceof j){var e=this.createWebWalletAccount(this._wallet.mnemonic);return this._wallet.accounts.push(e),this.setActiveAccount(e),e}}},{key:"getActiveAccount",value:function(){var e;return null===(e=this._wallet)||void 0===e?void 0:e.active}},{key:"setActiveAccount",value:function(e){return!!this._wallet&&(this._wallet.active=e,this._store.setItem(this._wallet),this.updateWallet(),!0)}},{key:"getAccounts",value:function(){return this._wallet?this._wallet.accounts:[]}},{key:"getValidSession",value:function(){var e=this._store.getItem();if(e&&e instanceof m){if((new Date).getTime()-e.timestamp<6e5)return e.session;console.log("Found expired session.",e)}}},{key:"resetWallet",value:function(){this._wallet=void 0,this._mnemonicDeriveIndex=0,this._store.clear()}},{key:"createWebWalletAccount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._mnemonicDeriveIndex,n=y.wallet.deriveAddress({mnemonics:e,index:t}),r=n.privateKey,a=new O({id:t.toString(),privateKey:r,address:y.wallet.createAddressByPrivateKey(r).address});return this._mnemonicDeriveIndex=t+1,a}},{key:"validateMnemonic",value:function(e){return!!e&&y.wallet.validateMnemonics(e)}}]),e}()},67:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));var r=n(24),a=n(4),i=n.n(a),c=n(7),o=n(10),s=n(11),u=n(33),l=n(16),d=n(110),h=n(43),f=n(147).WS_RPC,v={retryTimes:10,retryInterval:5e3},b=function(){function t(e,n){var r=this;Object(o.a)(this,t),this._emitter=void 0,this._factory=void 0,this._connector=void 0,this._provider=void 0,this._client=void 0,this._isConnected=!1,this.initAsync=function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r._isConnected=!1,r._provider&&r._provider.destroy(),r._connector=r._factory.create(t),r._provider=new f(t.rpcUrl,6e4,v);var a=!1;r._provider.on("error",(function(e){console.log(e),a||(n(e),r._isConnected=!1)})),r._client=new u.ViteAPI(r._provider,(function(){r._isConnected=!0,console.log("ViteAPI connected to ".concat(r._provider.path)),a=!0,e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.initConnectorAsync=function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._emitter=e,this._factory=n}return Object(s.a)(t,[{key:"isConnected",get:function(){return this._isConnected}},{key:"connector",get:function(){return this._connector}},{key:"dispose",value:function(){var e;console.log("Disposing ViteClient"),null===(e=this._provider)||void 0===e||e.disconnect(),this._isConnected=!1}},{key:"requestAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,a,c,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isConnected||!this._client){e.next=5;break}for(r=o.length,a=new Array(r>1?r-1:0),c=1;c<r;c++)a[c-1]=o[c];return e.abrupt("return",(n=this._client).request.apply(n,[t].concat(a)));case 5:return e.abrupt("return",Promise.reject("Vite client is not ready to make requests."));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSnapshotChainHeightAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.requestAsync("ledger_getSnapshotChainHeight"));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBalanceByAccount",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestAsync("ledger_getAccountInfoByAddress",t);case 2:return n=e.sent,e.abrupt("return",new l.a(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQuotaByAccount",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requestAsync("contract_getQuotaByAccount",t);case 2:return n=e.sent,e.abrupt("return",new l.d(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"callContractAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n,r,a,c,o){var s,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=u.accountBlock.createAccountBlock("callContract",{address:t.address,abi:r,methodName:n,amount:c,toAddress:o,params:a}),!(t instanceof h.i)){e.next=11;break}return s=s.setProvider(this._client).setPrivateKey(t.privateKey),e.next=5,s.autoSetPreviousAccountBlock();case 5:return e.next=7,s.sign().send();case 7:return l=e.sent,e.abrupt("return",l);case 11:if(!(t instanceof h.b)){e.next=31;break}if(!this.connector){e.next=28;break}return this._emitter.emitConfirmTransactionDialog(!0),e.prev=14,e.next=17,this.connector.sendTransactionAsync({block:s.accountBlock});case 17:return d=e.sent,this._emitter.emitConfirmTransactionDialog(!1),e.abrupt("return",d);case 22:throw e.prev=22,e.t0=e.catch(14),this._emitter.emitConfirmTransactionDialog(!1),e.t0;case 26:e.next=29;break;case 28:throw new Error("Connector is not defined");case 29:e.next=32;break;case 31:throw new Error("Account not supported");case 32:case"end":return e.stop()}}),e,this,[[14,22]])})));return function(t,n,r,a,i,c){return e.apply(this,arguments)}}()},{key:"callOffChainMethodAsync",value:function(){var t=Object(c.a)(i.a.mark((function t(n,r,a,c){var o,s,l,d,h,f,v,b,p;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=u.abi.encodeFunctionCall(r,c),s=e.from(o,"hex").toString("base64"),t.next=4,this.requestAsync("contract_callOffChainMethod",{selfAddr:n,offChainCode:a,data:s});case 4:if(!(l=t.sent)){t.next=13;break}for(d=e.from(l,"base64").toString("hex"),h=[],f=0;f<r.outputs.length;f++)h.push(r.outputs[f].type);if(v=u.abi.decodeParameters(h,d),b=[],v)for(p=0;p<r.outputs.length;p++)r.outputs[p].name?b.push({name:r.outputs[p].name,value:v[p]}):b.push({name:"",value:v[p]});return t.abrupt("return",b);case 13:return t.abrupt("return","");case 14:case"end":return t.stop()}}),t,this)})));return function(e,n,r,a){return t.apply(this,arguments)}}()},{key:"decodeVmLog",value:function(e,t){for(var n=e.topics,r=0;r<t.length;r++){var a=t[r];if(u.abi.encodeLogSignature(a)===n[0])if(e.data)return{topic:n[0],args:u.abi.decodeLog(a.inputs,u.utils._Buffer.from(e.data,"base64").toString("hex"),n.slice(1)),event:a.name}}}},{key:"createAddressListenerAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={addressHeightRange:{placeholder:{fromHeight:"0",toHeight:"0"}}},a=(a=JSON.stringify(r)).replace("placeholder",t),e.next=5,null===(n=this._client)||void 0===n?void 0:n.subscribe("createVmlogSubscription",JSON.parse(a));case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeListener",value:function(e){var t;null===(t=this._client)||void 0===t||t.unsubscribe(e)}},{key:"waitForAccountBlockAsync",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(i.a.mark((function e(o,s){var u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=void 0,l=void 0,new d.a(Object(c.a)(i.a.mark((function e(){var c,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.requestAsync("ledger_getAccountBlockByHeight",t,n);case 3:if(c=e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:if(o=c.receiveBlockHash){e.next=9;break}return e.abrupt("return",!0);case 9:return e.next=11,a.requestAsync("ledger_getAccountBlockByHash",o);case 11:if(s=e.sent){e.next=14;break}return e.abrupt("return",!0);case 14:return u=Object(r.a)(Object(r.a)({},a.getAccountBlockStatus(s)),{},{accountBlock:s}),e.abrupt("return",!1);case 18:return e.prev=18,e.t0=e.catch(0),l=e.t0,e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))),500).start((function(){l?s(l):o(u)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getAccountBlockStatus",value:function(e){var t=this.resolveAccountBlockData(e),n="";switch(t){case 0:n="0, Execution succeed";break;case 1:n="1, Execution reverted";break;case 2:n="2, Max call depth exceeded"}return{status:t,statusTxt:n}}},{key:"resolveAccountBlockData",value:function(e){if(4!==e.blockType&&5!==e.blockType||!e.data)return 0;var t=u.utils._Buffer.from(e.data,"base64");return 33!==t.length?0:t[32]}}]),t}()}).call(this,n(142).Buffer)}},[[151,1,2]]]);
//# sourceMappingURL=main.e07c9bcb.chunk.js.map